{"ast":null,"code":"/**\r\n * DevExtreme (esm/__internal/ui/context_menu/m_menu_base.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport devices from \"../../../core/devices\";\nimport $ from \"../../../core/renderer\";\nimport { asyncNoop, noop } from \"../../../core/utils/common\";\nimport { extend } from \"../../../core/utils/extend\";\nimport { each } from \"../../../core/utils/iterator\";\nimport { isDefined, isObject, isPlainObject } from \"../../../core/utils/type\";\nimport { render } from \"../../../ui/widget/utils.ink_ripple\";\nimport MenuItem from \"../../ui/collection/item\";\nimport MenuBaseEditStrategy from \"../../ui/context_menu/m_menu_base.edit.strategy\";\nimport HierarchicalCollectionWidget from \"../../ui/hierarchical_collection/m_hierarchical_collection_widget\";\nconst DX_MENU_CLASS = \"dx-menu\";\nconst DX_MENU_NO_ICONS_CLASS = \"dx-menu-no-icons\";\nconst DX_MENU_BASE_CLASS = \"dx-menu-base\";\nconst ITEM_CLASS = \"dx-menu-item\";\nconst DX_ITEM_CONTENT_CLASS = `${ITEM_CLASS}-content`;\nconst DX_MENU_SELECTED_ITEM_CLASS = `${ITEM_CLASS}-selected`;\nconst DX_MENU_ITEM_WRAPPER_CLASS = `${ITEM_CLASS}-wrapper`;\nconst DX_MENU_ITEMS_CONTAINER_CLASS = \"dx-menu-items-container\";\nconst DX_MENU_ITEM_EXPANDED_CLASS = `${ITEM_CLASS}-expanded`;\nconst DX_MENU_SEPARATOR_CLASS = \"dx-menu-separator\";\nconst DX_MENU_ITEM_LAST_GROUP_ITEM = \"dx-menu-last-group-item\";\nconst DX_ITEM_HAS_TEXT = `${ITEM_CLASS}-has-text`;\nconst DX_ITEM_HAS_ICON = `${ITEM_CLASS}-has-icon`;\nconst DX_ITEM_HAS_SUBMENU = `${ITEM_CLASS}-has-submenu`;\nconst DX_MENU_ITEM_POPOUT_CLASS = `${ITEM_CLASS}-popout`;\nconst DX_MENU_ITEM_POPOUT_CONTAINER_CLASS = `${DX_MENU_ITEM_POPOUT_CLASS}-container`;\nconst DX_MENU_ITEM_CAPTION_CLASS = `${ITEM_CLASS}-text`;\nconst SINGLE_SELECTION_MODE = \"single\";\nconst DEFAULT_DELAY = {\n  show: 50,\n  hide: 300\n};\nconst DX_MENU_ITEM_CAPTION_URL_CLASS = `${DX_MENU_ITEM_CAPTION_CLASS}-with-url`;\nconst DX_ICON_WITH_URL_CLASS = \"dx-icon-with-url\";\nconst ITEM_URL_CLASS = \"dx-item-url\";\nclass MenuBase extends HierarchicalCollectionWidget {\n  _getDefaultOptions() {\n    return extend(super._getDefaultOptions(), {\n      items: [],\n      cssClass: \"\",\n      activeStateEnabled: true,\n      showSubmenuMode: {\n        name: \"onHover\",\n        delay: {\n          show: 50,\n          hide: 300\n        }\n      },\n      animation: {\n        show: {\n          type: \"fade\",\n          from: 0,\n          to: 1,\n          duration: 100\n        },\n        hide: {\n          type: \"fade\",\n          from: 1,\n          to: 0,\n          duration: 100\n        }\n      },\n      selectByClick: false,\n      focusOnSelectedItem: false,\n      keyExpr: null,\n      _itemAttributes: {\n        role: \"menuitem\"\n      },\n      useInkRipple: false\n    });\n  }\n  _itemDataKey() {\n    return \"dxMenuItemDataKey\";\n  }\n  _itemClass() {\n    return ITEM_CLASS;\n  }\n  _setAriaSelectionAttribute($itemElement, isSelected) {}\n  _selectedItemClass() {\n    return DX_MENU_SELECTED_ITEM_CLASS;\n  }\n  _widgetClass() {\n    return \"dx-menu-base\";\n  }\n  _focusTarget() {\n    return this._itemContainer();\n  }\n  _clean() {\n    this.option(\"focusedElement\", null);\n    super._clean();\n  }\n  _supportedKeys() {\n    return extend(super._supportedKeys(), {\n      space: () => {\n        const $item = $(this.option(\"focusedElement\"));\n        if (!$item.length || !this._isSelectionEnabled()) {\n          return;\n        }\n        this.selectItem($item[0]);\n      },\n      pageUp: noop,\n      pageDown: noop\n    });\n  }\n  _isSelectionEnabled() {\n    const {\n      selectionMode: selectionMode\n    } = this.option();\n    return \"single\" === selectionMode;\n  }\n  _init() {\n    super._init();\n    this._activeStateUnit = `.${ITEM_CLASS}`;\n    this._renderSelectedItem();\n    this._initActions();\n  }\n  _getLinkContainer(iconContainer, textContainer, itemData) {\n    const {\n      linkAttr: linkAttr,\n      url: url\n    } = itemData;\n    null === iconContainer || void 0 === iconContainer || iconContainer.addClass(\"dx-icon-with-url\");\n    null === textContainer || void 0 === textContainer || textContainer.addClass(DX_MENU_ITEM_CAPTION_URL_CLASS);\n    return super._getLinkContainer(iconContainer, textContainer, {\n      linkAttr: linkAttr,\n      url: url\n    });\n  }\n  _addContent($container, itemData) {\n    const {\n      html: html,\n      url: url\n    } = itemData;\n    if (url) {\n      $container.html(html);\n      const link = this._getLinkContainer(this._getIconContainer(itemData), this._getTextContainer(itemData), itemData);\n      $container.append(link);\n    } else {\n      super._addContent($container, itemData);\n    }\n    $container.append(this._getPopoutContainer(itemData));\n    this._addContentClasses(itemData, $container.parent());\n  }\n  _getTextContainer(itemData) {\n    const {\n      text: text\n    } = itemData;\n    if (!text) {\n      return;\n    }\n    const $itemContainer = $(\"<span>\").addClass(DX_MENU_ITEM_CAPTION_CLASS);\n    const itemText = isPlainObject(itemData) ? text : String(itemData);\n    return $itemContainer.text(itemText);\n  }\n  _getItemExtraPropNames() {\n    return [\"url\", \"linkAttr\"];\n  }\n  _getPopoutContainer(itemData) {\n    const {\n      items: items\n    } = itemData;\n    let $popOutContainer;\n    if (null !== items && void 0 !== items && items.length) {\n      const $popOutImage = $(\"<div>\").addClass(DX_MENU_ITEM_POPOUT_CLASS);\n      $popOutContainer = $(\"<span>\").addClass(DX_MENU_ITEM_POPOUT_CONTAINER_CLASS).append($popOutImage);\n    }\n    return $popOutContainer;\n  }\n  _getDataAdapterOptions() {\n    return {\n      rootValue: 0,\n      multipleSelection: false,\n      recursiveSelection: false,\n      recursiveExpansion: false,\n      searchValue: \"\"\n    };\n  }\n  _selectByItem(selectedItem) {\n    if (!selectedItem) {\n      return;\n    }\n    const nodeToSelect = this._dataAdapter.getNodeByItem(selectedItem);\n    this._dataAdapter.toggleSelection(nodeToSelect.internalFields.key, true);\n  }\n  _renderSelectedItem() {\n    const selectedKeys = this._dataAdapter.getSelectedNodesKeys();\n    const selectedKey = selectedKeys.length && selectedKeys[0];\n    const selectedItem = this.option(\"selectedItem\");\n    if (!selectedKey) {\n      this._selectByItem(selectedItem);\n      return;\n    }\n    const node = this._dataAdapter.getNodeByKey(selectedKey);\n    if (false === node.selectable) {\n      return;\n    }\n    if (!selectedItem) {\n      this.option(\"selectedItem\", node.internalFields.item);\n      return;\n    }\n    if (selectedItem !== node.internalFields.item) {\n      this._dataAdapter.toggleSelection(selectedKey, false);\n      this._selectByItem(selectedItem);\n    }\n  }\n  _initActions() {}\n  _initMarkup() {\n    super._initMarkup();\n    this.option(\"useInkRipple\") && this._renderInkRipple();\n  }\n  _renderInkRipple() {\n    this._inkRipple = render();\n  }\n  _toggleActiveState($element, value, e) {\n    super._toggleActiveState.apply(this, arguments);\n    if (!this._inkRipple) {\n      return;\n    }\n    const config = {\n      element: $element,\n      event: e\n    };\n    if (value) {\n      this._inkRipple.showWave(config);\n    } else {\n      this._inkRipple.hideWave(config);\n    }\n  }\n  _getShowSubmenuMode() {\n    const {\n      showSubmenuMode: showSubmenuMode\n    } = this.option();\n    const showMode = isObject(showSubmenuMode) ? showSubmenuMode.name : showSubmenuMode;\n    return this._isDesktopDevice() ? showMode : \"onClick\";\n  }\n  _initSelectedItems() {}\n  _isDesktopDevice() {\n    return \"desktop\" === devices.real().deviceType;\n  }\n  _initEditStrategy() {\n    const Strategy = MenuBaseEditStrategy;\n    this._editStrategy = new Strategy(this);\n  }\n  _addCustomCssClass($element) {\n    $element.addClass(this.option(\"cssClass\"));\n  }\n  _itemWrapperSelector() {\n    return `.${DX_MENU_ITEM_WRAPPER_CLASS}`;\n  }\n  _hoverStartHandler(e) {\n    const $itemElement = this._getItemElementByEventArgs(e);\n    if (!$itemElement || this._isItemDisabled($itemElement)) {\n      return;\n    }\n    e.stopPropagation();\n    if (\"onHover\" === this._getShowSubmenuMode()) {\n      const submenuDelay = this._getSubmenuDelay(\"show\");\n      if (0 === submenuDelay) {\n        this._showSubmenu($itemElement);\n      } else {\n        clearTimeout(this._showSubmenusTimeout);\n        this._showSubmenusTimeout = setTimeout(this._showSubmenu.bind(this, $itemElement), submenuDelay);\n      }\n    }\n  }\n  _getAvailableItems($itemElements) {\n    return super._getAvailableItems($itemElements).filter(function () {\n      return \"hidden\" !== $(this).css(\"visibility\");\n    });\n  }\n  _isItemDisabled($item) {\n    return this._disabledGetter($item.data(this._itemDataKey()));\n  }\n  _showSubmenu($itemElement) {\n    this._addExpandedClass($itemElement);\n  }\n  _addExpandedClass(itemElement) {\n    $(itemElement).addClass(DX_MENU_ITEM_EXPANDED_CLASS);\n  }\n  _getSubmenuDelay(action) {\n    const {\n      delay: delay\n    } = this.option(\"showSubmenuMode\");\n    if (!isDefined(delay)) {\n      return DEFAULT_DELAY[action];\n    }\n    return isObject(delay) ? delay[action] : delay;\n  }\n  _getItemElementByEventArgs(eventArgs) {\n    let $target = $(eventArgs.target);\n    if ($target.hasClass(this._itemClass()) || $target.get(0) === eventArgs.currentTarget) {\n      return $target;\n    }\n    while (!$target.hasClass(this._itemClass())) {\n      $target = $target.parent();\n      if ($target.hasClass(\"dx-submenu\")) {\n        return null;\n      }\n    }\n    return $target;\n  }\n  _hoverEndHandler(event) {\n    clearTimeout(this._showSubmenusTimeout);\n  }\n  _hasSubmenu(node) {\n    return null === node || void 0 === node ? void 0 : node.internalFields.childrenKeys.length;\n  }\n  _renderContentImpl() {\n    this._renderItems(this._dataAdapter.getRootNodes());\n  }\n  _renderItems(nodes, submenuContainer) {\n    if (!nodes.length) {\n      return;\n    }\n    this.hasIcons = false;\n    const $nodeContainer = this._renderContainer(this.$element(), submenuContainer);\n    let firstVisibleIndex = -1;\n    let nextGroupFirstIndex = -1;\n    each(nodes, (index, node) => {\n      const isVisibleNode = false !== node.visible;\n      if (isVisibleNode && firstVisibleIndex < 0) {\n        firstVisibleIndex = index;\n      }\n      const isBeginGroup = firstVisibleIndex < index && (node.beginGroup || index === nextGroupFirstIndex);\n      if (isBeginGroup) {\n        nextGroupFirstIndex = isVisibleNode ? index : index + 1;\n      }\n      if (index === nextGroupFirstIndex && firstVisibleIndex < index) {\n        this._renderSeparator($nodeContainer);\n      }\n      this._renderItem(index, node, $nodeContainer);\n    });\n    if (!this.hasIcons) {\n      $nodeContainer.addClass(\"dx-menu-no-icons\");\n    }\n  }\n  _renderContainer($wrapper, submenuContainer) {\n    const $container = $(\"<ul>\");\n    this.setAria(\"role\", \"none\", $container);\n    return $container.appendTo($wrapper).addClass(\"dx-menu-items-container\");\n  }\n  _createDOMElement($nodeContainer) {\n    const $node = $(\"<li>\");\n    this.setAria(\"role\", \"none\", $node);\n    return $node.appendTo($nodeContainer).addClass(DX_MENU_ITEM_WRAPPER_CLASS);\n  }\n  _renderItem(index, node, $nodeContainer, $nodeElement) {\n    var _items;\n    const {\n      items = []\n    } = this.option();\n    const $node = $nodeElement ?? this._createDOMElement($nodeContainer);\n    if (null !== (_items = items[index + 1]) && void 0 !== _items && _items.beginGroup) {\n      $node.addClass(\"dx-menu-last-group-item\");\n    }\n    const $itemFrame = super._renderItem(index, node.internalFields.item, $node);\n    if (node.internalFields.item === this.option(\"selectedItem\")) {\n      $itemFrame.addClass(DX_MENU_SELECTED_ITEM_CLASS);\n    }\n    $itemFrame.attr(\"tabIndex\", -1);\n    if (this._hasSubmenu(node)) {\n      this.setAria(\"haspopup\", \"true\", $itemFrame);\n    }\n    return $itemFrame;\n  }\n  _renderItemFrame(index, itemData, $itemContainer) {\n    const $itemFrame = $itemContainer.children(`.${ITEM_CLASS}`);\n    return $itemFrame.length ? $itemFrame : super._renderItemFrame.apply(this, arguments);\n  }\n  _refreshItem($item, item) {\n    const node = this._dataAdapter.getNodeByItem(item);\n    const index = $item.data(this._itemIndexKey());\n    const $nodeContainer = $item.closest(\"ul\");\n    const $nodeElement = $item.closest(\"li\");\n    this._renderItem(index, node, $nodeContainer, $nodeElement);\n  }\n  _addContentClasses(itemData, $itemFrame) {\n    const hasText = itemData.text ? !!itemData.text.length : false;\n    const hasIcon = !!itemData.icon;\n    const hasSubmenu = itemData.items ? !!itemData.items.length : false;\n    $itemFrame.toggleClass(DX_ITEM_HAS_TEXT, hasText);\n    $itemFrame.toggleClass(DX_ITEM_HAS_ICON, hasIcon);\n    if (!this.hasIcons) {\n      this.hasIcons = hasIcon;\n    }\n    $itemFrame.toggleClass(DX_ITEM_HAS_SUBMENU, hasSubmenu);\n  }\n  _getItemContent($itemFrame) {\n    let $itemContent = super._getItemContent($itemFrame);\n    if (!$itemContent.length) {\n      $itemContent = $itemFrame.children(`.${DX_ITEM_CONTENT_CLASS}`);\n    }\n    return $itemContent;\n  }\n  _postprocessRenderItem(args) {\n    const $itemElement = $(args.itemElement);\n    const selectedIndex = this._dataAdapter.getSelectedNodesKeys();\n    if (!selectedIndex.length || !this._selectedGetter(args.itemData) || !this._isItemSelectable(args.itemData)) {\n      this._setAriaSelectionAttribute($itemElement, \"false\");\n      return;\n    }\n    const node = this._dataAdapter.getNodeByItem(args.itemData);\n    if (node.internalFields.key === selectedIndex[0]) {\n      $itemElement.addClass(this._selectedItemClass());\n      this._setAriaSelectionAttribute($itemElement, \"true\");\n    } else {\n      this._setAriaSelectionAttribute($itemElement, \"false\");\n    }\n  }\n  _isItemSelectable(item) {\n    return false !== item.selectable;\n  }\n  _renderSeparator($itemsContainer) {\n    $(\"<li>\").appendTo($itemsContainer).addClass(\"dx-menu-separator\");\n  }\n  _itemClickHandler(e) {\n    if (e._skipHandling) {\n      return;\n    }\n    const itemClickActionHandler = this._createAction(this._updateSubmenuVisibilityOnClick.bind(this));\n    this._itemDXEventHandler(e, \"onItemClick\", {}, {\n      beforeExecute: this._itemClick,\n      afterExecute: itemClickActionHandler.bind(this)\n    });\n    e._skipHandling = true;\n  }\n  _itemClick(actionArgs) {\n    const {\n      event: event,\n      itemData: itemData\n    } = actionArgs.args[0];\n    const $itemElement = this._getItemElementByEventArgs(event);\n    const link = $itemElement && $itemElement.find(\".dx-item-url\").get(0);\n    if (itemData.url && link) {\n      link.click();\n    }\n  }\n  _updateSubmenuVisibilityOnClick(actionArgs) {\n    this._updateSelectedItemOnClick(actionArgs);\n    if (\"onClick\" === this._getShowSubmenuMode()) {\n      this._addExpandedClass(actionArgs.args[0].itemElement);\n    }\n  }\n  _updateSelectedItemOnClick(actionArgs) {\n    const args = actionArgs.args ? actionArgs.args[0] : actionArgs;\n    if (!this._isItemSelectAllowed(args.itemData)) {\n      return;\n    }\n    const selectedItemKey = this._dataAdapter.getSelectedNodesKeys();\n    const selectedNode = selectedItemKey.length && this._dataAdapter.getNodeByKey(selectedItemKey[0]);\n    if (selectedNode) {\n      this._toggleItemSelection(selectedNode, false);\n    }\n    if (!selectedNode || selectedNode.internalFields.item !== args.itemData) {\n      this.selectItem(args.itemData);\n    } else {\n      this._fireSelectionChangeEvent(null, this.option(\"selectedItem\"));\n      this._setOptionWithoutOptionChange(\"selectedItem\", null);\n    }\n  }\n  _isItemSelectAllowed(item) {\n    const isSelectByClickEnabled = this._isSelectionEnabled() && this.option(\"selectByClick\");\n    return !this._isContainerEmpty() && isSelectByClickEnabled && this._isItemSelectable(item) && !this._itemsGetter(item);\n  }\n  _isContainerEmpty() {\n    return this._itemContainer().is(\":empty\");\n  }\n  _syncSelectionOptions() {\n    return asyncNoop();\n  }\n  _optionChanged(args) {\n    switch (args.name) {\n      case \"showSubmenuMode\":\n        break;\n      case \"selectedItem\":\n        {\n          const node = this._dataAdapter.getNodeByItem(args.value);\n          const selectedKey = this._dataAdapter.getSelectedNodesKeys()[0];\n          if (node && node.internalFields.key !== selectedKey) {\n            if (false === node.selectable) {\n              break;\n            }\n            if (selectedKey) {\n              this._toggleItemSelection(this._dataAdapter.getNodeByKey(selectedKey), false);\n            }\n            this._toggleItemSelection(node, true);\n            this._updateSelectedItems();\n          }\n          break;\n        }\n      case \"cssClass\":\n      case \"position\":\n      case \"selectByClick\":\n      case \"animation\":\n      case \"useInkRipple\":\n        this._invalidate();\n        break;\n      default:\n        super._optionChanged(args);\n    }\n  }\n  _toggleItemSelection(node, value) {\n    const itemElement = this._getElementByItem(node.internalFields.item);\n    itemElement && $(itemElement).toggleClass(DX_MENU_SELECTED_ITEM_CLASS);\n    this._dataAdapter.toggleSelection(node.internalFields.key, value);\n  }\n  _getElementByItem(itemData) {\n    let result;\n    each(this._itemElements(), (_, itemElement) => {\n      if ($(itemElement).data(this._itemDataKey()) !== itemData) {\n        return true;\n      }\n      result = itemElement;\n      return false;\n    });\n    return result;\n  }\n  _updateSelectedItems(oldSelection, newSelection) {\n    if (oldSelection || newSelection) {\n      this._fireSelectionChangeEvent(newSelection, oldSelection);\n    }\n  }\n  _fireSelectionChangeEvent(addedSelection, removedSelection) {\n    this._createActionByOption(\"onSelectionChanged\", {\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    })({\n      addedItems: [addedSelection],\n      removedItems: [removedSelection]\n    });\n  }\n  selectItem(itemElement) {\n    const itemData = itemElement.nodeType ? this._getItemData(itemElement) : itemElement;\n    const selectedKey = this._dataAdapter.getSelectedNodesKeys()[0];\n    const selectedItem = this.option(\"selectedItem\");\n    const node = this._dataAdapter.getNodeByItem(itemData);\n    if (node.internalFields.key !== selectedKey) {\n      if (selectedKey) {\n        this._toggleItemSelection(this._dataAdapter.getNodeByKey(selectedKey), false);\n      }\n      this._toggleItemSelection(node, true);\n      this._updateSelectedItems(selectedItem, itemData);\n      this._setOptionWithoutOptionChange(\"selectedItem\", itemData);\n    }\n  }\n  unselectItem(itemElement) {\n    const itemData = itemElement.nodeType ? this._getItemData(itemElement) : itemElement;\n    const node = this._dataAdapter.getNodeByItem(itemData);\n    const selectedItem = this.option(\"selectedItem\");\n    if (node.internalFields.selected) {\n      this._toggleItemSelection(node, false);\n      this._updateSelectedItems(selectedItem, null);\n      this._setOptionWithoutOptionChange(\"selectedItem\", null);\n    }\n  }\n}\nMenuBase.ItemClass = MenuItem;\nexport default MenuBase;","map":{"version":3,"names":["devices","$","asyncNoop","noop","extend","each","isDefined","isObject","isPlainObject","render","MenuItem","MenuBaseEditStrategy","HierarchicalCollectionWidget","DX_MENU_CLASS","DX_MENU_NO_ICONS_CLASS","DX_MENU_BASE_CLASS","ITEM_CLASS","DX_ITEM_CONTENT_CLASS","DX_MENU_SELECTED_ITEM_CLASS","DX_MENU_ITEM_WRAPPER_CLASS","DX_MENU_ITEMS_CONTAINER_CLASS","DX_MENU_ITEM_EXPANDED_CLASS","DX_MENU_SEPARATOR_CLASS","DX_MENU_ITEM_LAST_GROUP_ITEM","DX_ITEM_HAS_TEXT","DX_ITEM_HAS_ICON","DX_ITEM_HAS_SUBMENU","DX_MENU_ITEM_POPOUT_CLASS","DX_MENU_ITEM_POPOUT_CONTAINER_CLASS","DX_MENU_ITEM_CAPTION_CLASS","SINGLE_SELECTION_MODE","DEFAULT_DELAY","show","hide","DX_MENU_ITEM_CAPTION_URL_CLASS","DX_ICON_WITH_URL_CLASS","ITEM_URL_CLASS","MenuBase","_getDefaultOptions","items","cssClass","activeStateEnabled","showSubmenuMode","name","delay","animation","type","from","to","duration","selectByClick","focusOnSelectedItem","keyExpr","_itemAttributes","role","useInkRipple","_itemDataKey","_itemClass","_setAriaSelectionAttribute","$itemElement","isSelected","_selectedItemClass","_widgetClass","_focusTarget","_itemContainer","_clean","option","_supportedKeys","space","$item","length","_isSelectionEnabled","selectItem","pageUp","pageDown","selectionMode","_init","_activeStateUnit","_renderSelectedItem","_initActions","_getLinkContainer","iconContainer","textContainer","itemData","linkAttr","url","addClass","_addContent","$container","html","link","_getIconContainer","_getTextContainer","append","_getPopoutContainer","_addContentClasses","parent","text","$itemContainer","itemText","String","_getItemExtraPropNames","$popOutContainer","$popOutImage","_getDataAdapterOptions","rootValue","multipleSelection","recursiveSelection","recursiveExpansion","searchValue","_selectByItem","selectedItem","nodeToSelect","_dataAdapter","getNodeByItem","toggleSelection","internalFields","key","selectedKeys","getSelectedNodesKeys","selectedKey","node","getNodeByKey","selectable","item","_initMarkup","_renderInkRipple","_inkRipple","_toggleActiveState","$element","value","e","apply","arguments","config","element","event","showWave","hideWave","_getShowSubmenuMode","showMode","_isDesktopDevice","_initSelectedItems","real","deviceType","_initEditStrategy","Strategy","_editStrategy","_addCustomCssClass","_itemWrapperSelector","_hoverStartHandler","_getItemElementByEventArgs","_isItemDisabled","stopPropagation","submenuDelay","_getSubmenuDelay","_showSubmenu","clearTimeout","_showSubmenusTimeout","setTimeout","bind","_getAvailableItems","$itemElements","filter","css","_disabledGetter","data","_addExpandedClass","itemElement","action","eventArgs","$target","target","hasClass","get","currentTarget","_hoverEndHandler","_hasSubmenu","childrenKeys","_renderContentImpl","_renderItems","getRootNodes","nodes","submenuContainer","hasIcons","$nodeContainer","_renderContainer","firstVisibleIndex","nextGroupFirstIndex","index","isVisibleNode","visible","isBeginGroup","beginGroup","_renderSeparator","_renderItem","$wrapper","setAria","appendTo","_createDOMElement","$node","$nodeElement","_items","$itemFrame","attr","_renderItemFrame","children","_refreshItem","_itemIndexKey","closest","hasText","hasIcon","icon","hasSubmenu","toggleClass","_getItemContent","$itemContent","_postprocessRenderItem","args","selectedIndex","_selectedGetter","_isItemSelectable","$itemsContainer","_itemClickHandler","_skipHandling","itemClickActionHandler","_createAction","_updateSubmenuVisibilityOnClick","_itemDXEventHandler","beforeExecute","_itemClick","afterExecute","actionArgs","find","click","_updateSelectedItemOnClick","_isItemSelectAllowed","selectedItemKey","selectedNode","_toggleItemSelection","_fireSelectionChangeEvent","_setOptionWithoutOptionChange","isSelectByClickEnabled","_isContainerEmpty","_itemsGetter","is","_syncSelectionOptions","_optionChanged","_updateSelectedItems","_invalidate","_getElementByItem","result","_itemElements","_","oldSelection","newSelection","addedSelection","removedSelection","_createActionByOption","excludeValidators","addedItems","removedItems","nodeType","_getItemData","unselectItem","selected","ItemClass"],"sources":["C:/Users/Sofia/Desktop/Репозиторий ЦК/internship_project/client/node_modules/devextreme/esm/__internal/ui/context_menu/m_menu_base.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/__internal/ui/context_menu/m_menu_base.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport devices from \"../../../core/devices\";\r\nimport $ from \"../../../core/renderer\";\r\nimport {\r\n    asyncNoop,\r\n    noop\r\n} from \"../../../core/utils/common\";\r\nimport {\r\n    extend\r\n} from \"../../../core/utils/extend\";\r\nimport {\r\n    each\r\n} from \"../../../core/utils/iterator\";\r\nimport {\r\n    isDefined,\r\n    isObject,\r\n    isPlainObject\r\n} from \"../../../core/utils/type\";\r\nimport {\r\n    render\r\n} from \"../../../ui/widget/utils.ink_ripple\";\r\nimport MenuItem from \"../../ui/collection/item\";\r\nimport MenuBaseEditStrategy from \"../../ui/context_menu/m_menu_base.edit.strategy\";\r\nimport HierarchicalCollectionWidget from \"../../ui/hierarchical_collection/m_hierarchical_collection_widget\";\r\nconst DX_MENU_CLASS = \"dx-menu\";\r\nconst DX_MENU_NO_ICONS_CLASS = \"dx-menu-no-icons\";\r\nconst DX_MENU_BASE_CLASS = \"dx-menu-base\";\r\nconst ITEM_CLASS = \"dx-menu-item\";\r\nconst DX_ITEM_CONTENT_CLASS = `${ITEM_CLASS}-content`;\r\nconst DX_MENU_SELECTED_ITEM_CLASS = `${ITEM_CLASS}-selected`;\r\nconst DX_MENU_ITEM_WRAPPER_CLASS = `${ITEM_CLASS}-wrapper`;\r\nconst DX_MENU_ITEMS_CONTAINER_CLASS = \"dx-menu-items-container\";\r\nconst DX_MENU_ITEM_EXPANDED_CLASS = `${ITEM_CLASS}-expanded`;\r\nconst DX_MENU_SEPARATOR_CLASS = \"dx-menu-separator\";\r\nconst DX_MENU_ITEM_LAST_GROUP_ITEM = \"dx-menu-last-group-item\";\r\nconst DX_ITEM_HAS_TEXT = `${ITEM_CLASS}-has-text`;\r\nconst DX_ITEM_HAS_ICON = `${ITEM_CLASS}-has-icon`;\r\nconst DX_ITEM_HAS_SUBMENU = `${ITEM_CLASS}-has-submenu`;\r\nconst DX_MENU_ITEM_POPOUT_CLASS = `${ITEM_CLASS}-popout`;\r\nconst DX_MENU_ITEM_POPOUT_CONTAINER_CLASS = `${DX_MENU_ITEM_POPOUT_CLASS}-container`;\r\nconst DX_MENU_ITEM_CAPTION_CLASS = `${ITEM_CLASS}-text`;\r\nconst SINGLE_SELECTION_MODE = \"single\";\r\nconst DEFAULT_DELAY = {\r\n    show: 50,\r\n    hide: 300\r\n};\r\nconst DX_MENU_ITEM_CAPTION_URL_CLASS = `${DX_MENU_ITEM_CAPTION_CLASS}-with-url`;\r\nconst DX_ICON_WITH_URL_CLASS = \"dx-icon-with-url\";\r\nconst ITEM_URL_CLASS = \"dx-item-url\";\r\nclass MenuBase extends HierarchicalCollectionWidget {\r\n    _getDefaultOptions() {\r\n        return extend(super._getDefaultOptions(), {\r\n            items: [],\r\n            cssClass: \"\",\r\n            activeStateEnabled: true,\r\n            showSubmenuMode: {\r\n                name: \"onHover\",\r\n                delay: {\r\n                    show: 50,\r\n                    hide: 300\r\n                }\r\n            },\r\n            animation: {\r\n                show: {\r\n                    type: \"fade\",\r\n                    from: 0,\r\n                    to: 1,\r\n                    duration: 100\r\n                },\r\n                hide: {\r\n                    type: \"fade\",\r\n                    from: 1,\r\n                    to: 0,\r\n                    duration: 100\r\n                }\r\n            },\r\n            selectByClick: false,\r\n            focusOnSelectedItem: false,\r\n            keyExpr: null,\r\n            _itemAttributes: {\r\n                role: \"menuitem\"\r\n            },\r\n            useInkRipple: false\r\n        })\r\n    }\r\n    _itemDataKey() {\r\n        return \"dxMenuItemDataKey\"\r\n    }\r\n    _itemClass() {\r\n        return ITEM_CLASS\r\n    }\r\n    _setAriaSelectionAttribute($itemElement, isSelected) {}\r\n    _selectedItemClass() {\r\n        return DX_MENU_SELECTED_ITEM_CLASS\r\n    }\r\n    _widgetClass() {\r\n        return \"dx-menu-base\"\r\n    }\r\n    _focusTarget() {\r\n        return this._itemContainer()\r\n    }\r\n    _clean() {\r\n        this.option(\"focusedElement\", null);\r\n        super._clean()\r\n    }\r\n    _supportedKeys() {\r\n        return extend(super._supportedKeys(), {\r\n            space: () => {\r\n                const $item = $(this.option(\"focusedElement\"));\r\n                if (!$item.length || !this._isSelectionEnabled()) {\r\n                    return\r\n                }\r\n                this.selectItem($item[0])\r\n            },\r\n            pageUp: noop,\r\n            pageDown: noop\r\n        })\r\n    }\r\n    _isSelectionEnabled() {\r\n        const {\r\n            selectionMode: selectionMode\r\n        } = this.option();\r\n        return \"single\" === selectionMode\r\n    }\r\n    _init() {\r\n        super._init();\r\n        this._activeStateUnit = `.${ITEM_CLASS}`;\r\n        this._renderSelectedItem();\r\n        this._initActions()\r\n    }\r\n    _getLinkContainer(iconContainer, textContainer, itemData) {\r\n        const {\r\n            linkAttr: linkAttr,\r\n            url: url\r\n        } = itemData;\r\n        null === iconContainer || void 0 === iconContainer || iconContainer.addClass(\"dx-icon-with-url\");\r\n        null === textContainer || void 0 === textContainer || textContainer.addClass(DX_MENU_ITEM_CAPTION_URL_CLASS);\r\n        return super._getLinkContainer(iconContainer, textContainer, {\r\n            linkAttr: linkAttr,\r\n            url: url\r\n        })\r\n    }\r\n    _addContent($container, itemData) {\r\n        const {\r\n            html: html,\r\n            url: url\r\n        } = itemData;\r\n        if (url) {\r\n            $container.html(html);\r\n            const link = this._getLinkContainer(this._getIconContainer(itemData), this._getTextContainer(itemData), itemData);\r\n            $container.append(link)\r\n        } else {\r\n            super._addContent($container, itemData)\r\n        }\r\n        $container.append(this._getPopoutContainer(itemData));\r\n        this._addContentClasses(itemData, $container.parent())\r\n    }\r\n    _getTextContainer(itemData) {\r\n        const {\r\n            text: text\r\n        } = itemData;\r\n        if (!text) {\r\n            return\r\n        }\r\n        const $itemContainer = $(\"<span>\").addClass(DX_MENU_ITEM_CAPTION_CLASS);\r\n        const itemText = isPlainObject(itemData) ? text : String(itemData);\r\n        return $itemContainer.text(itemText)\r\n    }\r\n    _getItemExtraPropNames() {\r\n        return [\"url\", \"linkAttr\"]\r\n    }\r\n    _getPopoutContainer(itemData) {\r\n        const {\r\n            items: items\r\n        } = itemData;\r\n        let $popOutContainer;\r\n        if (null !== items && void 0 !== items && items.length) {\r\n            const $popOutImage = $(\"<div>\").addClass(DX_MENU_ITEM_POPOUT_CLASS);\r\n            $popOutContainer = $(\"<span>\").addClass(DX_MENU_ITEM_POPOUT_CONTAINER_CLASS).append($popOutImage)\r\n        }\r\n        return $popOutContainer\r\n    }\r\n    _getDataAdapterOptions() {\r\n        return {\r\n            rootValue: 0,\r\n            multipleSelection: false,\r\n            recursiveSelection: false,\r\n            recursiveExpansion: false,\r\n            searchValue: \"\"\r\n        }\r\n    }\r\n    _selectByItem(selectedItem) {\r\n        if (!selectedItem) {\r\n            return\r\n        }\r\n        const nodeToSelect = this._dataAdapter.getNodeByItem(selectedItem);\r\n        this._dataAdapter.toggleSelection(nodeToSelect.internalFields.key, true)\r\n    }\r\n    _renderSelectedItem() {\r\n        const selectedKeys = this._dataAdapter.getSelectedNodesKeys();\r\n        const selectedKey = selectedKeys.length && selectedKeys[0];\r\n        const selectedItem = this.option(\"selectedItem\");\r\n        if (!selectedKey) {\r\n            this._selectByItem(selectedItem);\r\n            return\r\n        }\r\n        const node = this._dataAdapter.getNodeByKey(selectedKey);\r\n        if (false === node.selectable) {\r\n            return\r\n        }\r\n        if (!selectedItem) {\r\n            this.option(\"selectedItem\", node.internalFields.item);\r\n            return\r\n        }\r\n        if (selectedItem !== node.internalFields.item) {\r\n            this._dataAdapter.toggleSelection(selectedKey, false);\r\n            this._selectByItem(selectedItem)\r\n        }\r\n    }\r\n    _initActions() {}\r\n    _initMarkup() {\r\n        super._initMarkup();\r\n        this.option(\"useInkRipple\") && this._renderInkRipple()\r\n    }\r\n    _renderInkRipple() {\r\n        this._inkRipple = render()\r\n    }\r\n    _toggleActiveState($element, value, e) {\r\n        super._toggleActiveState.apply(this, arguments);\r\n        if (!this._inkRipple) {\r\n            return\r\n        }\r\n        const config = {\r\n            element: $element,\r\n            event: e\r\n        };\r\n        if (value) {\r\n            this._inkRipple.showWave(config)\r\n        } else {\r\n            this._inkRipple.hideWave(config)\r\n        }\r\n    }\r\n    _getShowSubmenuMode() {\r\n        const {\r\n            showSubmenuMode: showSubmenuMode\r\n        } = this.option();\r\n        const showMode = isObject(showSubmenuMode) ? showSubmenuMode.name : showSubmenuMode;\r\n        return this._isDesktopDevice() ? showMode : \"onClick\"\r\n    }\r\n    _initSelectedItems() {}\r\n    _isDesktopDevice() {\r\n        return \"desktop\" === devices.real().deviceType\r\n    }\r\n    _initEditStrategy() {\r\n        const Strategy = MenuBaseEditStrategy;\r\n        this._editStrategy = new Strategy(this)\r\n    }\r\n    _addCustomCssClass($element) {\r\n        $element.addClass(this.option(\"cssClass\"))\r\n    }\r\n    _itemWrapperSelector() {\r\n        return `.${DX_MENU_ITEM_WRAPPER_CLASS}`\r\n    }\r\n    _hoverStartHandler(e) {\r\n        const $itemElement = this._getItemElementByEventArgs(e);\r\n        if (!$itemElement || this._isItemDisabled($itemElement)) {\r\n            return\r\n        }\r\n        e.stopPropagation();\r\n        if (\"onHover\" === this._getShowSubmenuMode()) {\r\n            const submenuDelay = this._getSubmenuDelay(\"show\");\r\n            if (0 === submenuDelay) {\r\n                this._showSubmenu($itemElement)\r\n            } else {\r\n                clearTimeout(this._showSubmenusTimeout);\r\n                this._showSubmenusTimeout = setTimeout(this._showSubmenu.bind(this, $itemElement), submenuDelay)\r\n            }\r\n        }\r\n    }\r\n    _getAvailableItems($itemElements) {\r\n        return super._getAvailableItems($itemElements).filter((function() {\r\n            return \"hidden\" !== $(this).css(\"visibility\")\r\n        }))\r\n    }\r\n    _isItemDisabled($item) {\r\n        return this._disabledGetter($item.data(this._itemDataKey()))\r\n    }\r\n    _showSubmenu($itemElement) {\r\n        this._addExpandedClass($itemElement)\r\n    }\r\n    _addExpandedClass(itemElement) {\r\n        $(itemElement).addClass(DX_MENU_ITEM_EXPANDED_CLASS)\r\n    }\r\n    _getSubmenuDelay(action) {\r\n        const {\r\n            delay: delay\r\n        } = this.option(\"showSubmenuMode\");\r\n        if (!isDefined(delay)) {\r\n            return DEFAULT_DELAY[action]\r\n        }\r\n        return isObject(delay) ? delay[action] : delay\r\n    }\r\n    _getItemElementByEventArgs(eventArgs) {\r\n        let $target = $(eventArgs.target);\r\n        if ($target.hasClass(this._itemClass()) || $target.get(0) === eventArgs.currentTarget) {\r\n            return $target\r\n        }\r\n        while (!$target.hasClass(this._itemClass())) {\r\n            $target = $target.parent();\r\n            if ($target.hasClass(\"dx-submenu\")) {\r\n                return null\r\n            }\r\n        }\r\n        return $target\r\n    }\r\n    _hoverEndHandler(event) {\r\n        clearTimeout(this._showSubmenusTimeout)\r\n    }\r\n    _hasSubmenu(node) {\r\n        return null === node || void 0 === node ? void 0 : node.internalFields.childrenKeys.length\r\n    }\r\n    _renderContentImpl() {\r\n        this._renderItems(this._dataAdapter.getRootNodes())\r\n    }\r\n    _renderItems(nodes, submenuContainer) {\r\n        if (!nodes.length) {\r\n            return\r\n        }\r\n        this.hasIcons = false;\r\n        const $nodeContainer = this._renderContainer(this.$element(), submenuContainer);\r\n        let firstVisibleIndex = -1;\r\n        let nextGroupFirstIndex = -1;\r\n        each(nodes, ((index, node) => {\r\n            const isVisibleNode = false !== node.visible;\r\n            if (isVisibleNode && firstVisibleIndex < 0) {\r\n                firstVisibleIndex = index\r\n            }\r\n            const isBeginGroup = firstVisibleIndex < index && (node.beginGroup || index === nextGroupFirstIndex);\r\n            if (isBeginGroup) {\r\n                nextGroupFirstIndex = isVisibleNode ? index : index + 1\r\n            }\r\n            if (index === nextGroupFirstIndex && firstVisibleIndex < index) {\r\n                this._renderSeparator($nodeContainer)\r\n            }\r\n            this._renderItem(index, node, $nodeContainer)\r\n        }));\r\n        if (!this.hasIcons) {\r\n            $nodeContainer.addClass(\"dx-menu-no-icons\")\r\n        }\r\n    }\r\n    _renderContainer($wrapper, submenuContainer) {\r\n        const $container = $(\"<ul>\");\r\n        this.setAria(\"role\", \"none\", $container);\r\n        return $container.appendTo($wrapper).addClass(\"dx-menu-items-container\")\r\n    }\r\n    _createDOMElement($nodeContainer) {\r\n        const $node = $(\"<li>\");\r\n        this.setAria(\"role\", \"none\", $node);\r\n        return $node.appendTo($nodeContainer).addClass(DX_MENU_ITEM_WRAPPER_CLASS)\r\n    }\r\n    _renderItem(index, node, $nodeContainer, $nodeElement) {\r\n        var _items;\r\n        const {\r\n            items: items = []\r\n        } = this.option();\r\n        const $node = $nodeElement ?? this._createDOMElement($nodeContainer);\r\n        if (null !== (_items = items[index + 1]) && void 0 !== _items && _items.beginGroup) {\r\n            $node.addClass(\"dx-menu-last-group-item\")\r\n        }\r\n        const $itemFrame = super._renderItem(index, node.internalFields.item, $node);\r\n        if (node.internalFields.item === this.option(\"selectedItem\")) {\r\n            $itemFrame.addClass(DX_MENU_SELECTED_ITEM_CLASS)\r\n        }\r\n        $itemFrame.attr(\"tabIndex\", -1);\r\n        if (this._hasSubmenu(node)) {\r\n            this.setAria(\"haspopup\", \"true\", $itemFrame)\r\n        }\r\n        return $itemFrame\r\n    }\r\n    _renderItemFrame(index, itemData, $itemContainer) {\r\n        const $itemFrame = $itemContainer.children(`.${ITEM_CLASS}`);\r\n        return $itemFrame.length ? $itemFrame : super._renderItemFrame.apply(this, arguments)\r\n    }\r\n    _refreshItem($item, item) {\r\n        const node = this._dataAdapter.getNodeByItem(item);\r\n        const index = $item.data(this._itemIndexKey());\r\n        const $nodeContainer = $item.closest(\"ul\");\r\n        const $nodeElement = $item.closest(\"li\");\r\n        this._renderItem(index, node, $nodeContainer, $nodeElement)\r\n    }\r\n    _addContentClasses(itemData, $itemFrame) {\r\n        const hasText = itemData.text ? !!itemData.text.length : false;\r\n        const hasIcon = !!itemData.icon;\r\n        const hasSubmenu = itemData.items ? !!itemData.items.length : false;\r\n        $itemFrame.toggleClass(DX_ITEM_HAS_TEXT, hasText);\r\n        $itemFrame.toggleClass(DX_ITEM_HAS_ICON, hasIcon);\r\n        if (!this.hasIcons) {\r\n            this.hasIcons = hasIcon\r\n        }\r\n        $itemFrame.toggleClass(DX_ITEM_HAS_SUBMENU, hasSubmenu)\r\n    }\r\n    _getItemContent($itemFrame) {\r\n        let $itemContent = super._getItemContent($itemFrame);\r\n        if (!$itemContent.length) {\r\n            $itemContent = $itemFrame.children(`.${DX_ITEM_CONTENT_CLASS}`)\r\n        }\r\n        return $itemContent\r\n    }\r\n    _postprocessRenderItem(args) {\r\n        const $itemElement = $(args.itemElement);\r\n        const selectedIndex = this._dataAdapter.getSelectedNodesKeys();\r\n        if (!selectedIndex.length || !this._selectedGetter(args.itemData) || !this._isItemSelectable(args.itemData)) {\r\n            this._setAriaSelectionAttribute($itemElement, \"false\");\r\n            return\r\n        }\r\n        const node = this._dataAdapter.getNodeByItem(args.itemData);\r\n        if (node.internalFields.key === selectedIndex[0]) {\r\n            $itemElement.addClass(this._selectedItemClass());\r\n            this._setAriaSelectionAttribute($itemElement, \"true\")\r\n        } else {\r\n            this._setAriaSelectionAttribute($itemElement, \"false\")\r\n        }\r\n    }\r\n    _isItemSelectable(item) {\r\n        return false !== item.selectable\r\n    }\r\n    _renderSeparator($itemsContainer) {\r\n        $(\"<li>\").appendTo($itemsContainer).addClass(\"dx-menu-separator\")\r\n    }\r\n    _itemClickHandler(e) {\r\n        if (e._skipHandling) {\r\n            return\r\n        }\r\n        const itemClickActionHandler = this._createAction(this._updateSubmenuVisibilityOnClick.bind(this));\r\n        this._itemDXEventHandler(e, \"onItemClick\", {}, {\r\n            beforeExecute: this._itemClick,\r\n            afterExecute: itemClickActionHandler.bind(this)\r\n        });\r\n        e._skipHandling = true\r\n    }\r\n    _itemClick(actionArgs) {\r\n        const {\r\n            event: event,\r\n            itemData: itemData\r\n        } = actionArgs.args[0];\r\n        const $itemElement = this._getItemElementByEventArgs(event);\r\n        const link = $itemElement && $itemElement.find(\".dx-item-url\").get(0);\r\n        if (itemData.url && link) {\r\n            link.click()\r\n        }\r\n    }\r\n    _updateSubmenuVisibilityOnClick(actionArgs) {\r\n        this._updateSelectedItemOnClick(actionArgs);\r\n        if (\"onClick\" === this._getShowSubmenuMode()) {\r\n            this._addExpandedClass(actionArgs.args[0].itemElement)\r\n        }\r\n    }\r\n    _updateSelectedItemOnClick(actionArgs) {\r\n        const args = actionArgs.args ? actionArgs.args[0] : actionArgs;\r\n        if (!this._isItemSelectAllowed(args.itemData)) {\r\n            return\r\n        }\r\n        const selectedItemKey = this._dataAdapter.getSelectedNodesKeys();\r\n        const selectedNode = selectedItemKey.length && this._dataAdapter.getNodeByKey(selectedItemKey[0]);\r\n        if (selectedNode) {\r\n            this._toggleItemSelection(selectedNode, false)\r\n        }\r\n        if (!selectedNode || selectedNode.internalFields.item !== args.itemData) {\r\n            this.selectItem(args.itemData)\r\n        } else {\r\n            this._fireSelectionChangeEvent(null, this.option(\"selectedItem\"));\r\n            this._setOptionWithoutOptionChange(\"selectedItem\", null)\r\n        }\r\n    }\r\n    _isItemSelectAllowed(item) {\r\n        const isSelectByClickEnabled = this._isSelectionEnabled() && this.option(\"selectByClick\");\r\n        return !this._isContainerEmpty() && isSelectByClickEnabled && this._isItemSelectable(item) && !this._itemsGetter(item)\r\n    }\r\n    _isContainerEmpty() {\r\n        return this._itemContainer().is(\":empty\")\r\n    }\r\n    _syncSelectionOptions() {\r\n        return asyncNoop()\r\n    }\r\n    _optionChanged(args) {\r\n        switch (args.name) {\r\n            case \"showSubmenuMode\":\r\n                break;\r\n            case \"selectedItem\": {\r\n                const node = this._dataAdapter.getNodeByItem(args.value);\r\n                const selectedKey = this._dataAdapter.getSelectedNodesKeys()[0];\r\n                if (node && node.internalFields.key !== selectedKey) {\r\n                    if (false === node.selectable) {\r\n                        break\r\n                    }\r\n                    if (selectedKey) {\r\n                        this._toggleItemSelection(this._dataAdapter.getNodeByKey(selectedKey), false)\r\n                    }\r\n                    this._toggleItemSelection(node, true);\r\n                    this._updateSelectedItems()\r\n                }\r\n                break\r\n            }\r\n            case \"cssClass\":\r\n            case \"position\":\r\n            case \"selectByClick\":\r\n            case \"animation\":\r\n            case \"useInkRipple\":\r\n                this._invalidate();\r\n                break;\r\n            default:\r\n                super._optionChanged(args)\r\n        }\r\n    }\r\n    _toggleItemSelection(node, value) {\r\n        const itemElement = this._getElementByItem(node.internalFields.item);\r\n        itemElement && $(itemElement).toggleClass(DX_MENU_SELECTED_ITEM_CLASS);\r\n        this._dataAdapter.toggleSelection(node.internalFields.key, value)\r\n    }\r\n    _getElementByItem(itemData) {\r\n        let result;\r\n        each(this._itemElements(), ((_, itemElement) => {\r\n            if ($(itemElement).data(this._itemDataKey()) !== itemData) {\r\n                return true\r\n            }\r\n            result = itemElement;\r\n            return false\r\n        }));\r\n        return result\r\n    }\r\n    _updateSelectedItems(oldSelection, newSelection) {\r\n        if (oldSelection || newSelection) {\r\n            this._fireSelectionChangeEvent(newSelection, oldSelection)\r\n        }\r\n    }\r\n    _fireSelectionChangeEvent(addedSelection, removedSelection) {\r\n        this._createActionByOption(\"onSelectionChanged\", {\r\n            excludeValidators: [\"disabled\", \"readOnly\"]\r\n        })({\r\n            addedItems: [addedSelection],\r\n            removedItems: [removedSelection]\r\n        })\r\n    }\r\n    selectItem(itemElement) {\r\n        const itemData = itemElement.nodeType ? this._getItemData(itemElement) : itemElement;\r\n        const selectedKey = this._dataAdapter.getSelectedNodesKeys()[0];\r\n        const selectedItem = this.option(\"selectedItem\");\r\n        const node = this._dataAdapter.getNodeByItem(itemData);\r\n        if (node.internalFields.key !== selectedKey) {\r\n            if (selectedKey) {\r\n                this._toggleItemSelection(this._dataAdapter.getNodeByKey(selectedKey), false)\r\n            }\r\n            this._toggleItemSelection(node, true);\r\n            this._updateSelectedItems(selectedItem, itemData);\r\n            this._setOptionWithoutOptionChange(\"selectedItem\", itemData)\r\n        }\r\n    }\r\n    unselectItem(itemElement) {\r\n        const itemData = itemElement.nodeType ? this._getItemData(itemElement) : itemElement;\r\n        const node = this._dataAdapter.getNodeByItem(itemData);\r\n        const selectedItem = this.option(\"selectedItem\");\r\n        if (node.internalFields.selected) {\r\n            this._toggleItemSelection(node, false);\r\n            this._updateSelectedItems(selectedItem, null);\r\n            this._setOptionWithoutOptionChange(\"selectedItem\", null)\r\n        }\r\n    }\r\n}\r\nMenuBase.ItemClass = MenuItem;\r\nexport default MenuBase;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}