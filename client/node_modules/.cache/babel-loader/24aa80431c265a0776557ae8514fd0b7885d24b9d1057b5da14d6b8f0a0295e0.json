{"ast":null,"code":"/**\r\n * DevExtreme (esm/__internal/filter_builder/m_utils.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport messageLocalization from \"../../common/core/localization/message\";\nimport { DataSource } from \"../../common/data/data_source/data_source\";\nimport { errors as dataErrors } from \"../../common/data/errors\";\nimport $ from \"../../core/renderer\";\nimport { compileGetter } from \"../../core/utils/data\";\nimport { Deferred, when } from \"../../core/utils/deferred\";\nimport { extend } from \"../../core/utils/extend\";\nimport { captionize } from \"../../core/utils/inflector\";\nimport { isDefined, isFunction } from \"../../core/utils/type\";\nimport formatHelper from \"../../format_helper\";\nimport filterUtils from \"../../ui/shared/filtering\";\nimport errors from \"../../ui/widget/ui.errors\";\nimport { getConfig } from \"./m_between\";\nimport filterOperationsDictionary from \"./m_filter_operations_dictionary\";\nconst DEFAULT_DATA_TYPE = \"string\";\nconst EMPTY_MENU_ICON = \"icon-none\";\nconst AND_GROUP_OPERATION = \"and\";\nconst EQUAL_OPERATION = \"=\";\nconst NOT_EQUAL_OPERATION = \"<>\";\nconst DATATYPE_OPERATIONS = {\n  number: [\"=\", \"<>\", \"<\", \">\", \"<=\", \">=\", \"isblank\", \"isnotblank\"],\n  string: [\"contains\", \"notcontains\", \"startswith\", \"endswith\", \"=\", \"<>\", \"isblank\", \"isnotblank\"],\n  date: [\"=\", \"<>\", \"<\", \">\", \"<=\", \">=\", \"isblank\", \"isnotblank\"],\n  datetime: [\"=\", \"<>\", \"<\", \">\", \"<=\", \">=\", \"isblank\", \"isnotblank\"],\n  boolean: [\"=\", \"<>\", \"isblank\", \"isnotblank\"],\n  object: [\"isblank\", \"isnotblank\"]\n};\nconst DEFAULT_FORMAT = {\n  date: \"shortDate\",\n  datetime: \"shortDateShortTime\"\n};\nconst LOOKUP_OPERATIONS = [\"=\", \"<>\", \"isblank\", \"isnotblank\"];\nconst AVAILABLE_FIELD_PROPERTIES = [\"caption\", \"customizeText\", \"dataField\", \"dataType\", \"editorTemplate\", \"falseText\", \"editorOptions\", \"filterOperations\", \"format\", \"lookup\", \"trueText\", \"calculateFilterExpression\", \"name\"];\nconst FILTER_BUILDER_CLASS = \"dx-filterbuilder\";\nconst FILTER_BUILDER_ITEM_TEXT_CLASS = \"dx-filterbuilder-text\";\nconst FILTER_BUILDER_ITEM_TEXT_PART_CLASS = \"dx-filterbuilder-text-part\";\nconst FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS = \"dx-filterbuilder-text-separator\";\nconst FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS = \"dx-filterbuilder-text-separator-empty\";\nfunction getFormattedValueText(field, value) {\n  const fieldFormat = field.format || DEFAULT_FORMAT[field.dataType];\n  return formatHelper.format(value, fieldFormat);\n}\nfunction isNegationGroup(group) {\n  return group && group.length > 1 && \"!\" === group[0] && !isCondition(group);\n}\nexport function getGroupCriteria(group) {\n  return isNegationGroup(group) ? group[1] : group;\n}\nfunction setGroupCriteria(group, criteria) {\n  if (isNegationGroup(group)) {\n    group[1] = criteria;\n  } else {\n    group = criteria;\n  }\n  return group;\n}\nfunction convertGroupToNewStructure(group, value) {\n  if (function (value) {\n    return -1 !== value.indexOf(\"!\");\n  }(value)) {\n    if (!isNegationGroup(group)) {\n      !function (group) {\n        const criteria = group.slice(0);\n        group.length = 0;\n        group.push(\"!\", criteria);\n      }(group);\n    }\n  } else if (isNegationGroup(group)) {\n    !function (group) {\n      const criteria = getGroupCriteria(group);\n      group.length = 0;\n      [].push.apply(group, criteria);\n    }(group);\n  }\n}\nexport function setGroupValue(group, value) {\n  convertGroupToNewStructure(group, value);\n  const criteria = getGroupCriteria(group);\n  let i;\n  value = function (value) {\n    return -1 === value.indexOf(\"!\") ? value : value.substring(1);\n  }(value);\n  !function (criteria, value) {\n    for (i = 0; i < criteria.length; i++) {\n      if (!Array.isArray(criteria[i])) {\n        criteria[i] = value;\n      }\n    }\n  }(criteria, value);\n  return group;\n}\nexport function getGroupMenuItem(group, availableGroups) {\n  const groupValue = getGroupValue(group);\n  return availableGroups.filter(item => item.value === groupValue)[0];\n}\nfunction getCriteriaOperation(criteria) {\n  if (isCondition(criteria)) {\n    return \"and\";\n  }\n  let value = \"\";\n  for (let i = 0; i < criteria.length; i++) {\n    const item = criteria[i];\n    if (!Array.isArray(item)) {\n      if (value && value !== item) {\n        throw dataErrors.Error(\"E4019\");\n      }\n      if (\"!\" !== item) {\n        value = item;\n      }\n    }\n  }\n  return value;\n}\nexport function getGroupValue(group) {\n  const criteria = getGroupCriteria(group);\n  let value = getCriteriaOperation(criteria);\n  if (!value) {\n    value = \"and\";\n  }\n  if (criteria !== group) {\n    value = `!${value}`;\n  }\n  return value;\n}\nfunction getDefaultFilterOperations(field) {\n  return field.lookup && LOOKUP_OPERATIONS || DATATYPE_OPERATIONS[field.dataType || \"string\"];\n}\nfunction containItems(entity) {\n  return Array.isArray(entity) && entity.length;\n}\nexport function getFilterOperations(field) {\n  const result = containItems(field.filterOperations) ? field.filterOperations : getDefaultFilterOperations(field);\n  return extend([], result);\n}\nexport function getCaptionByOperation(operation, filterOperationDescriptions) {\n  const operationName = filterOperationsDictionary.getNameByFilterOperation(operation);\n  return filterOperationDescriptions && filterOperationDescriptions[operationName] ? filterOperationDescriptions[operationName] : operationName;\n}\nexport function getOperationFromAvailable(operation, availableOperations) {\n  for (let i = 0; i < availableOperations.length; i++) {\n    if (availableOperations[i].value === operation) {\n      return availableOperations[i];\n    }\n  }\n  throw new errors.Error(\"E1048\", operation);\n}\nexport function getCustomOperation(customOperations, name) {\n  const filteredOperations = customOperations.filter(item => item.name === name);\n  return filteredOperations.length ? filteredOperations[0] : null;\n}\nexport function getAvailableOperations(field, filterOperationDescriptions, customOperations) {\n  const filterOperations = getFilterOperations(field);\n  const isLookupField = !!field.lookup;\n  customOperations.forEach(customOperation => {\n    if (!field.filterOperations && -1 === filterOperations.indexOf(customOperation.name)) {\n      const dataTypes = customOperation && customOperation.dataTypes;\n      const isOperationForbidden = isLookupField ? !!customOperation.notForLookup : false;\n      if (!isOperationForbidden && dataTypes && dataTypes.indexOf(field.dataType || \"string\") >= 0) {\n        filterOperations.push(customOperation.name);\n      }\n    }\n  });\n  return filterOperations.map(operation => {\n    const customOperation = getCustomOperation(customOperations, operation);\n    if (customOperation) {\n      return {\n        icon: customOperation.icon || \"icon-none\",\n        text: customOperation.caption || captionize(customOperation.name),\n        value: customOperation.name,\n        isCustom: true\n      };\n    }\n    return {\n      icon: filterOperationsDictionary.getIconByFilterOperation(operation) || \"icon-none\",\n      text: getCaptionByOperation(operation, filterOperationDescriptions),\n      value: operation\n    };\n  });\n}\nexport function getDefaultOperation(field) {\n  return field.defaultFilterOperation || getFilterOperations(field)[0];\n}\nexport function createCondition(field, customOperations) {\n  const condition = [field.dataField, \"\", \"\"];\n  const filterOperation = getDefaultOperation(field);\n  updateConditionByOperation(condition, filterOperation, customOperations);\n  return condition;\n}\nexport function removeItem(group, item) {\n  const criteria = getGroupCriteria(group);\n  const index = criteria.indexOf(item);\n  criteria.splice(index, 1);\n  if (1 !== criteria.length) {\n    criteria.splice(index, 1);\n  }\n  return group;\n}\nexport function createEmptyGroup(value) {\n  const isNegation = isNegationGroupOperation(value);\n  const groupOperation = isNegation ? getGroupOperationFromNegationOperation(value) : value;\n  return isNegation ? [\"!\", [groupOperation]] : [groupOperation];\n}\nexport function isEmptyGroup(group) {\n  const criteria = getGroupCriteria(group);\n  if (isCondition(criteria)) {\n    return false;\n  }\n  const hasConditions = criteria.some(item => isCondition(item));\n  return !hasConditions;\n}\nexport function addItem(item, group) {\n  const criteria = getGroupCriteria(group);\n  const groupValue = getGroupValue(criteria);\n  1 === criteria.length ? criteria.unshift(item) : criteria.push(item, groupValue);\n  return group;\n}\nexport function getField(dataField, fields) {\n  for (let i = 0; i < fields.length; i++) {\n    if (fields[i].name === dataField) {\n      return fields[i];\n    }\n    if (fields[i].dataField.toLowerCase() === dataField.toLowerCase()) {\n      return fields[i];\n    }\n  }\n  const extendedFields = getItems(fields, true).filter(item => item.dataField.toLowerCase() === dataField.toLowerCase());\n  if (extendedFields.length > 0) {\n    return extendedFields[0];\n  }\n  throw new errors.Error(\"E1047\", dataField);\n}\nexport function isGroup(criteria) {\n  if (!Array.isArray(criteria)) {\n    return false;\n  }\n  return criteria.length < 2 || Array.isArray(criteria[0]) || Array.isArray(criteria[1]);\n}\nexport function isCondition(criteria) {\n  if (!Array.isArray(criteria)) {\n    return false;\n  }\n  return criteria.length > 1 && !Array.isArray(criteria[0]) && !Array.isArray(criteria[1]);\n}\nfunction convertToInnerGroup(group, customOperations, defaultGroupOperation) {\n  defaultGroupOperation = defaultGroupOperation || \"and\";\n  const groupOperation = getCriteriaOperation(group).toLowerCase() || defaultGroupOperation;\n  let innerGroup = [];\n  for (let i = 0; i < group.length; i++) {\n    if (isGroup(group[i])) {\n      innerGroup.push(convertToInnerStructure(group[i], customOperations, defaultGroupOperation));\n      innerGroup = appendGroupOperationToGroup(innerGroup, groupOperation);\n    } else if (isCondition(group[i])) {\n      innerGroup.push(convertToInnerCondition(group[i], customOperations));\n      innerGroup = appendGroupOperationToGroup(innerGroup, groupOperation);\n    }\n  }\n  if (0 === innerGroup.length) {\n    innerGroup = appendGroupOperationToGroup(innerGroup, groupOperation);\n  }\n  return innerGroup;\n}\nfunction conditionHasCustomOperation(condition, customOperations) {\n  const customOperation = getCustomOperation(customOperations, condition[1]);\n  return customOperation && customOperation.name === condition[1];\n}\nfunction convertToInnerCondition(condition, customOperations) {\n  if (conditionHasCustomOperation(condition, customOperations)) {\n    return condition;\n  }\n  if (condition.length < 3) {\n    condition[2] = condition[1];\n    condition[1] = \"=\";\n  }\n  return condition;\n}\nfunction isNegationGroupOperation(operation) {\n  return -1 !== operation.indexOf(\"not\");\n}\nfunction getGroupOperationFromNegationOperation(operation) {\n  return operation.substring(3).toLowerCase();\n}\nfunction appendGroupOperationToCriteria(criteria, groupOperation) {\n  const isNegation = isNegationGroupOperation(groupOperation);\n  groupOperation = isNegation ? getGroupOperationFromNegationOperation(groupOperation) : groupOperation;\n  return isNegation ? [\"!\", criteria, groupOperation] : [criteria, groupOperation];\n}\nfunction appendGroupOperationToGroup(group, groupOperation) {\n  const isNegation = isNegationGroupOperation(groupOperation);\n  groupOperation = isNegation ? getGroupOperationFromNegationOperation(groupOperation) : groupOperation;\n  group.push(groupOperation);\n  let result = group;\n  if (isNegation) {\n    result = [\"!\", result];\n  }\n  return result;\n}\nexport function convertToInnerStructure(value, customOperations, defaultGroupOperation) {\n  defaultGroupOperation = defaultGroupOperation || \"and\";\n  if (!value) {\n    return createEmptyGroup(defaultGroupOperation);\n  }\n  value = extend(true, [], value);\n  if (isCondition(value)) {\n    return appendGroupOperationToCriteria(convertToInnerCondition(value, customOperations), defaultGroupOperation);\n  }\n  if (isNegationGroup(value)) {\n    return [\"!\", isCondition(value[1]) ? appendGroupOperationToCriteria(convertToInnerCondition(value[1], customOperations), defaultGroupOperation) : isNegationGroup(value[1]) ? appendGroupOperationToCriteria(convertToInnerStructure(value[1], customOperations), defaultGroupOperation) : convertToInnerGroup(value[1], customOperations, defaultGroupOperation)];\n  }\n  return convertToInnerGroup(value, customOperations, defaultGroupOperation);\n}\nexport function getNormalizedFields(fields) {\n  return fields.reduce((result, field) => {\n    if (isDefined(field.dataField)) {\n      const normalizedField = {};\n      for (const key in field) {\n        if (field[key] && AVAILABLE_FIELD_PROPERTIES.includes(key)) {\n          normalizedField[key] = field[key];\n        }\n      }\n      normalizedField.defaultCalculateFilterExpression = filterUtils.defaultCalculateFilterExpression;\n      if (!isDefined(normalizedField.dataType)) {\n        normalizedField.dataType = \"string\";\n      }\n      if (!isDefined(normalizedField.trueText)) {\n        normalizedField.trueText = messageLocalization.format(\"dxDataGrid-trueText\");\n      }\n      if (!isDefined(normalizedField.falseText)) {\n        normalizedField.falseText = messageLocalization.format(\"dxDataGrid-falseText\");\n      }\n      result.push(normalizedField);\n    }\n    return result;\n  }, []);\n}\nfunction getConditionFilterExpression(condition, fields, customOperations, target) {\n  const field = getField(condition[0], fields);\n  const filterExpression = convertToInnerCondition(condition, customOperations);\n  const customOperation = customOperations.length && getCustomOperation(customOperations, filterExpression[1]);\n  if (customOperation && customOperation.calculateFilterExpression) {\n    return customOperation.calculateFilterExpression.apply(customOperation, [filterExpression[2], field, fields]);\n  }\n  if (field.createFilterExpression) {\n    return field.createFilterExpression.apply(field, [filterExpression[2], filterExpression[1], target]);\n  }\n  if (field.calculateFilterExpression) {\n    return field.calculateFilterExpression.apply(field, [filterExpression[2], filterExpression[1], target]);\n  }\n  return field.defaultCalculateFilterExpression.apply(field, [filterExpression[2], filterExpression[1], target]);\n}\nexport function getFilterExpression(value, fields, customOperations, target) {\n  if (!isDefined(value)) {\n    return null;\n  }\n  if (isNegationGroup(value)) {\n    const filterExpression = getFilterExpression(value[1], fields, customOperations, target);\n    return [\"!\", filterExpression];\n  }\n  const criteria = getGroupCriteria(value);\n  if (isCondition(criteria)) {\n    return getConditionFilterExpression(criteria, fields, customOperations, target) || null;\n  }\n  let result = [];\n  let filterExpression;\n  const groupValue = getGroupValue(criteria);\n  for (let i = 0; i < criteria.length; i++) {\n    if (isGroup(criteria[i])) {\n      filterExpression = getFilterExpression(criteria[i], fields, customOperations, target);\n      if (filterExpression) {\n        i && result.push(groupValue);\n        result.push(filterExpression);\n      }\n    } else if (isCondition(criteria[i])) {\n      filterExpression = getConditionFilterExpression(criteria[i], fields, customOperations, target);\n      if (filterExpression) {\n        result.length && result.push(groupValue);\n        result.push(filterExpression);\n      }\n    }\n  }\n  if (1 === result.length) {\n    result = result[0];\n  }\n  return result.length ? result : null;\n}\nexport function getNormalizedFilter(group) {\n  const criteria = getGroupCriteria(group);\n  let i;\n  if (0 === criteria.length) {\n    return null;\n  }\n  const itemsForRemove = [];\n  for (i = 0; i < criteria.length; i++) {\n    if (isGroup(criteria[i])) {\n      const normalizedGroupValue = getNormalizedFilter(criteria[i]);\n      if (normalizedGroupValue) {\n        criteria[i] = normalizedGroupValue;\n      } else {\n        itemsForRemove.push(criteria[i]);\n      }\n    } else if (isCondition(criteria[i])) {\n      if (!isValidCondition(criteria[i])) {\n        itemsForRemove.push(criteria[i]);\n      }\n    }\n  }\n  for (i = 0; i < itemsForRemove.length; i++) {\n    removeItem(criteria, itemsForRemove[i]);\n  }\n  if (1 === criteria.length) {\n    return null;\n  }\n  criteria.splice(criteria.length - 1, 1);\n  if (1 === criteria.length) {\n    group = setGroupCriteria(group, criteria[0]);\n  }\n  if (0 === group.length) {\n    return null;\n  }\n  return group;\n}\nexport function getCurrentLookupValueText(field, value, handler) {\n  if (\"\" === value) {\n    handler(\"\");\n    return;\n  }\n  const {\n    lookup: lookup\n  } = field;\n  if (lookup.items) {\n    handler(lookup.calculateCellValue(value) || \"\");\n  } else {\n    const lookupDataSource = isFunction(lookup.dataSource) ? lookup.dataSource({}) : lookup.dataSource;\n    const dataSource = new DataSource(lookupDataSource);\n    dataSource.loadSingle(lookup.valueExpr, value).done(result => {\n      let valueText = \"\";\n      if (result) {\n        valueText = lookup.displayExpr ? compileGetter(lookup.displayExpr)(result) : result;\n      }\n      if (field.customizeText) {\n        valueText = field.customizeText({\n          value: value,\n          valueText: valueText\n        });\n      }\n      handler(valueText);\n    }).fail(() => {\n      handler(\"\");\n    });\n  }\n}\nfunction getPrimitiveValueText(field, value, customOperation, target, options) {\n  let valueText;\n  if (true === value) {\n    valueText = field.trueText || messageLocalization.format(\"dxDataGrid-trueText\");\n  } else if (false === value) {\n    valueText = field.falseText || messageLocalization.format(\"dxDataGrid-falseText\");\n  } else {\n    valueText = getFormattedValueText(field, value);\n  }\n  if (field.customizeText) {\n    valueText = field.customizeText.call(field, {\n      value: value,\n      valueText: valueText,\n      target: target\n    });\n  }\n  if (customOperation && customOperation.customizeText) {\n    valueText = customOperation.customizeText.call(customOperation, {\n      value: value,\n      valueText: valueText,\n      field: field,\n      target: target\n    }, options);\n  }\n  return valueText;\n}\nfunction getArrayValueText(field, value, customOperation, target) {\n  const options = {\n    values: value\n  };\n  return value.map(v => getPrimitiveValueText(field, v, customOperation, target, options));\n}\nfunction checkDefaultValue(value) {\n  return \"\" === value || null === value;\n}\nexport function getCurrentValueText(field, value, customOperation) {\n  let target = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : \"filterBuilder\";\n  if (checkDefaultValue(value)) {\n    return \"\";\n  }\n  if (Array.isArray(value)) {\n    const result = new Deferred();\n    when.apply(this, getArrayValueText(field, value, customOperation, target)).done(function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      const text = args.some(item => !checkDefaultValue(item)) ? args.map(item => !checkDefaultValue(item) ? item : \"?\") : \"\";\n      result.resolve(text);\n    });\n    return result;\n  }\n  return getPrimitiveValueText(field, value, customOperation, target);\n}\nfunction itemExists(plainItems, parentId) {\n  return plainItems.some(item => item.dataField === parentId);\n}\nfunction pushItemAndCheckParent(originalItems, plainItems, item) {\n  const {\n    dataField: dataField\n  } = item;\n  if (hasParent(dataField)) {\n    item.parentId = getParentIdFromItemDataField(dataField);\n    if (!itemExists(plainItems, item.parentId) && !itemExists(originalItems, item.parentId)) {\n      pushItemAndCheckParent(originalItems, plainItems, {\n        id: item.parentId,\n        dataType: \"object\",\n        dataField: item.parentId,\n        caption: generateCaptionByDataField(item.parentId, true),\n        filterOperations: [\"isblank\", \"isnotblank\"],\n        defaultCalculateFilterExpression: filterUtils.defaultCalculateFilterExpression\n      });\n    }\n  }\n  plainItems.push(item);\n}\nfunction generateCaptionByDataField(dataField, allowHierarchicalFields) {\n  let caption = \"\";\n  if (allowHierarchicalFields) {\n    dataField = dataField.substring(dataField.lastIndexOf(\".\") + 1);\n  } else if (hasParent(dataField)) {\n    dataField.split(\".\").forEach((field, index, arr) => {\n      caption += captionize(field);\n      if (index !== arr.length - 1) {\n        caption += \".\";\n      }\n    });\n    return caption;\n  }\n  return captionize(dataField);\n}\nexport function getItems(fields, allowHierarchicalFields) {\n  const items = [];\n  for (let i = 0; i < fields.length; i++) {\n    const item = extend(true, {\n      caption: generateCaptionByDataField(fields[i].dataField, allowHierarchicalFields)\n    }, fields[i]);\n    item.id = item.name || item.dataField;\n    if (allowHierarchicalFields) {\n      pushItemAndCheckParent(fields, items, item);\n    } else {\n      items.push(item);\n    }\n  }\n  return items;\n}\nfunction hasParent(dataField) {\n  return -1 !== dataField.lastIndexOf(\".\");\n}\nfunction getParentIdFromItemDataField(dataField) {\n  return dataField.substring(0, dataField.lastIndexOf(\".\"));\n}\nexport function getCaptionWithParents(item, plainItems) {\n  if (hasParent(item.dataField)) {\n    const parentId = getParentIdFromItemDataField(item.dataField);\n    for (let i = 0; i < plainItems.length; i++) {\n      if (plainItems[i].dataField === parentId) {\n        return `${getCaptionWithParents(plainItems[i], plainItems)}.${item.caption}`;\n      }\n    }\n  }\n  return item.caption;\n}\nexport function updateConditionByOperation(condition, operation, customOperations) {\n  let customOperation = getCustomOperation(customOperations, operation);\n  if (customOperation) {\n    if (false === customOperation.hasValue) {\n      condition[1] = operation;\n      condition.length = 2;\n    } else {\n      condition[1] = operation;\n      condition[2] = \"\";\n    }\n    return condition;\n  }\n  if (\"isblank\" === operation) {\n    condition[1] = \"=\";\n    condition[2] = null;\n  } else if (\"isnotblank\" === operation) {\n    condition[1] = \"<>\";\n    condition[2] = null;\n  } else {\n    customOperation = getCustomOperation(customOperations, condition[1]);\n    if (customOperation || 2 === condition.length || null === condition[2]) {\n      condition[2] = \"\";\n    }\n    condition[1] = operation;\n  }\n  return condition;\n}\nexport function getOperationValue(condition) {\n  let caption;\n  if (null === condition[2]) {\n    if (\"=\" === condition[1]) {\n      caption = \"isblank\";\n    } else {\n      caption = \"isnotblank\";\n    }\n  } else {\n    caption = condition[1];\n  }\n  return caption;\n}\nexport function isValidCondition(condition) {\n  return \"\" !== condition[2];\n}\nexport function getMergedOperations(customOperations, betweenCaption, context) {\n  const result = extend(true, [], customOperations);\n  let betweenIndex = -1;\n  result.some((customOperation, index) => {\n    if (\"between\" === customOperation.name) {\n      betweenIndex = index;\n      return true;\n    }\n    return;\n  });\n  if (-1 !== betweenIndex) {\n    result[betweenIndex] = extend(getConfig(betweenCaption, context), result[betweenIndex]);\n  } else {\n    result.unshift(getConfig(betweenCaption, context));\n  }\n  return result;\n}\nfunction isMatchedCondition(filter, addedFilterDataField) {\n  return filter[0] === addedFilterDataField;\n}\nexport function removeFieldConditionsFromFilter(filter, dataField) {\n  if (!filter || 0 === filter.length) {\n    return null;\n  }\n  if (isCondition(filter)) {\n    const hasMatchedCondition = isMatchedCondition(filter, dataField);\n    return !hasMatchedCondition ? filter : null;\n  }\n  return syncConditionIntoGroup(filter, [dataField], false);\n}\nfunction syncConditionIntoGroup(filter, addedFilter, canPush) {\n  const result = [];\n  filter.forEach(item => {\n    if (isCondition(item)) {\n      if (isMatchedCondition(item, addedFilter[0])) {\n        if (canPush) {\n          result.push(addedFilter);\n          canPush = false;\n        } else {\n          result.splice(result.length - 1, 1);\n        }\n      } else {\n        result.push(item);\n      }\n    } else {\n      (result.length || isGroup(item)) && result.push(item);\n    }\n  });\n  if (0 === result.length) {\n    return null;\n  }\n  if (canPush) {\n    result.push(\"and\");\n    result.push(addedFilter);\n  }\n  return 1 === result.length ? result[0] : result;\n}\nexport function syncFilters(filter, addedFilter) {\n  if (null === filter || 0 === filter.length) {\n    return addedFilter;\n  }\n  if (isCondition(filter)) {\n    if (isMatchedCondition(filter, addedFilter[0])) {\n      return addedFilter;\n    }\n    return [filter, \"and\", addedFilter];\n  }\n  const groupValue = getGroupValue(filter);\n  if (\"and\" !== groupValue) {\n    return [addedFilter, \"and\", filter];\n  }\n  return syncConditionIntoGroup(filter, addedFilter, true);\n}\nexport function getMatchedConditions(filter, dataField) {\n  if (null === filter || 0 === filter.length) {\n    return [];\n  }\n  if (isCondition(filter)) {\n    if (isMatchedCondition(filter, dataField)) {\n      return [filter];\n    }\n    return [];\n  }\n  const groupValue = getGroupValue(filter);\n  if (\"and\" !== groupValue) {\n    return [];\n  }\n  const result = filter.filter(item => isCondition(item) && isMatchedCondition(item, dataField));\n  return result;\n}\nexport function filterHasField(filter, dataField) {\n  if (null === filter || 0 === filter.length) {\n    return false;\n  }\n  if (isCondition(filter)) {\n    return filter[0] === dataField;\n  }\n  return filter.some(item => (isCondition(item) || isGroup(item)) && filterHasField(item, dataField));\n}\nexport const renderValueText = function ($container, value, customOperation) {\n  if (Array.isArray(value)) {\n    const lastItemIndex = value.length - 1;\n    $container.empty();\n    value.forEach((t, i) => {\n      $(\"<span>\").addClass(\"dx-filterbuilder-text-part\").text(t).appendTo($container);\n      if (i !== lastItemIndex) {\n        $(\"<span>\").addClass(\"dx-filterbuilder-text-separator\").text(customOperation && customOperation.valueSeparator ? customOperation.valueSeparator : \"|\").addClass(\"dx-filterbuilder-text-separator-empty\").appendTo($container);\n      }\n    });\n  } else if (value) {\n    $container.text(value);\n  } else {\n    $container.text(messageLocalization.format(\"dxFilterBuilder-enterValueText\"));\n  }\n};","map":{"version":3,"names":["messageLocalization","DataSource","errors","dataErrors","$","compileGetter","Deferred","when","extend","captionize","isDefined","isFunction","formatHelper","filterUtils","getConfig","filterOperationsDictionary","DEFAULT_DATA_TYPE","EMPTY_MENU_ICON","AND_GROUP_OPERATION","EQUAL_OPERATION","NOT_EQUAL_OPERATION","DATATYPE_OPERATIONS","number","string","date","datetime","boolean","object","DEFAULT_FORMAT","LOOKUP_OPERATIONS","AVAILABLE_FIELD_PROPERTIES","FILTER_BUILDER_CLASS","FILTER_BUILDER_ITEM_TEXT_CLASS","FILTER_BUILDER_ITEM_TEXT_PART_CLASS","FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS","FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS","getFormattedValueText","field","value","fieldFormat","format","dataType","isNegationGroup","group","length","isCondition","getGroupCriteria","setGroupCriteria","criteria","convertGroupToNewStructure","indexOf","slice","push","apply","setGroupValue","i","substring","Array","isArray","getGroupMenuItem","availableGroups","groupValue","getGroupValue","filter","item","getCriteriaOperation","Error","getDefaultFilterOperations","lookup","containItems","entity","getFilterOperations","result","filterOperations","getCaptionByOperation","operation","filterOperationDescriptions","operationName","getNameByFilterOperation","getOperationFromAvailable","availableOperations","getCustomOperation","customOperations","name","filteredOperations","getAvailableOperations","isLookupField","forEach","customOperation","dataTypes","isOperationForbidden","notForLookup","map","icon","text","caption","isCustom","getIconByFilterOperation","getDefaultOperation","defaultFilterOperation","createCondition","condition","dataField","filterOperation","updateConditionByOperation","removeItem","index","splice","createEmptyGroup","isNegation","isNegationGroupOperation","groupOperation","getGroupOperationFromNegationOperation","isEmptyGroup","hasConditions","some","addItem","unshift","getField","fields","toLowerCase","extendedFields","getItems","isGroup","convertToInnerGroup","defaultGroupOperation","innerGroup","convertToInnerStructure","appendGroupOperationToGroup","convertToInnerCondition","conditionHasCustomOperation","appendGroupOperationToCriteria","getNormalizedFields","reduce","normalizedField","key","includes","defaultCalculateFilterExpression","trueText","falseText","getConditionFilterExpression","target","filterExpression","calculateFilterExpression","createFilterExpression","getFilterExpression","getNormalizedFilter","itemsForRemove","normalizedGroupValue","isValidCondition","getCurrentLookupValueText","handler","items","calculateCellValue","lookupDataSource","dataSource","loadSingle","valueExpr","done","valueText","displayExpr","customizeText","fail","getPrimitiveValueText","options","call","getArrayValueText","values","v","checkDefaultValue","getCurrentValueText","arguments","_len","args","_key","resolve","itemExists","plainItems","parentId","pushItemAndCheckParent","originalItems","hasParent","getParentIdFromItemDataField","id","generateCaptionByDataField","allowHierarchicalFields","lastIndexOf","split","arr","getCaptionWithParents","hasValue","getOperationValue","getMergedOperations","betweenCaption","context","betweenIndex","isMatchedCondition","addedFilterDataField","removeFieldConditionsFromFilter","hasMatchedCondition","syncConditionIntoGroup","addedFilter","canPush","syncFilters","getMatchedConditions","filterHasField","renderValueText","$container","lastItemIndex","empty","t","addClass","appendTo","valueSeparator"],"sources":["C:/Users/Sofia/Desktop/Репозиторий ЦК/internship_project/client/node_modules/devextreme/esm/__internal/filter_builder/m_utils.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/__internal/filter_builder/m_utils.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport messageLocalization from \"../../common/core/localization/message\";\r\nimport {\r\n    DataSource\r\n} from \"../../common/data/data_source/data_source\";\r\nimport {\r\n    errors as dataErrors\r\n} from \"../../common/data/errors\";\r\nimport $ from \"../../core/renderer\";\r\nimport {\r\n    compileGetter\r\n} from \"../../core/utils/data\";\r\nimport {\r\n    Deferred,\r\n    when\r\n} from \"../../core/utils/deferred\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    captionize\r\n} from \"../../core/utils/inflector\";\r\nimport {\r\n    isDefined,\r\n    isFunction\r\n} from \"../../core/utils/type\";\r\nimport formatHelper from \"../../format_helper\";\r\nimport filterUtils from \"../../ui/shared/filtering\";\r\nimport errors from \"../../ui/widget/ui.errors\";\r\nimport {\r\n    getConfig\r\n} from \"./m_between\";\r\nimport filterOperationsDictionary from \"./m_filter_operations_dictionary\";\r\nconst DEFAULT_DATA_TYPE = \"string\";\r\nconst EMPTY_MENU_ICON = \"icon-none\";\r\nconst AND_GROUP_OPERATION = \"and\";\r\nconst EQUAL_OPERATION = \"=\";\r\nconst NOT_EQUAL_OPERATION = \"<>\";\r\nconst DATATYPE_OPERATIONS = {\r\n    number: [\"=\", \"<>\", \"<\", \">\", \"<=\", \">=\", \"isblank\", \"isnotblank\"],\r\n    string: [\"contains\", \"notcontains\", \"startswith\", \"endswith\", \"=\", \"<>\", \"isblank\", \"isnotblank\"],\r\n    date: [\"=\", \"<>\", \"<\", \">\", \"<=\", \">=\", \"isblank\", \"isnotblank\"],\r\n    datetime: [\"=\", \"<>\", \"<\", \">\", \"<=\", \">=\", \"isblank\", \"isnotblank\"],\r\n    boolean: [\"=\", \"<>\", \"isblank\", \"isnotblank\"],\r\n    object: [\"isblank\", \"isnotblank\"]\r\n};\r\nconst DEFAULT_FORMAT = {\r\n    date: \"shortDate\",\r\n    datetime: \"shortDateShortTime\"\r\n};\r\nconst LOOKUP_OPERATIONS = [\"=\", \"<>\", \"isblank\", \"isnotblank\"];\r\nconst AVAILABLE_FIELD_PROPERTIES = [\"caption\", \"customizeText\", \"dataField\", \"dataType\", \"editorTemplate\", \"falseText\", \"editorOptions\", \"filterOperations\", \"format\", \"lookup\", \"trueText\", \"calculateFilterExpression\", \"name\"];\r\nconst FILTER_BUILDER_CLASS = \"dx-filterbuilder\";\r\nconst FILTER_BUILDER_ITEM_TEXT_CLASS = \"dx-filterbuilder-text\";\r\nconst FILTER_BUILDER_ITEM_TEXT_PART_CLASS = \"dx-filterbuilder-text-part\";\r\nconst FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS = \"dx-filterbuilder-text-separator\";\r\nconst FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS = \"dx-filterbuilder-text-separator-empty\";\r\n\r\nfunction getFormattedValueText(field, value) {\r\n    const fieldFormat = field.format || DEFAULT_FORMAT[field.dataType];\r\n    return formatHelper.format(value, fieldFormat)\r\n}\r\n\r\nfunction isNegationGroup(group) {\r\n    return group && group.length > 1 && \"!\" === group[0] && !isCondition(group)\r\n}\r\nexport function getGroupCriteria(group) {\r\n    return isNegationGroup(group) ? group[1] : group\r\n}\r\n\r\nfunction setGroupCriteria(group, criteria) {\r\n    if (isNegationGroup(group)) {\r\n        group[1] = criteria\r\n    } else {\r\n        group = criteria\r\n    }\r\n    return group\r\n}\r\n\r\nfunction convertGroupToNewStructure(group, value) {\r\n    if (function(value) {\r\n            return -1 !== value.indexOf(\"!\")\r\n        }(value)) {\r\n        if (!isNegationGroup(group)) {\r\n            ! function(group) {\r\n                const criteria = group.slice(0);\r\n                group.length = 0;\r\n                group.push(\"!\", criteria)\r\n            }(group)\r\n        }\r\n    } else if (isNegationGroup(group)) {\r\n        ! function(group) {\r\n            const criteria = getGroupCriteria(group);\r\n            group.length = 0;\r\n            [].push.apply(group, criteria)\r\n        }(group)\r\n    }\r\n}\r\nexport function setGroupValue(group, value) {\r\n    convertGroupToNewStructure(group, value);\r\n    const criteria = getGroupCriteria(group);\r\n    let i;\r\n    value = function(value) {\r\n        return -1 === value.indexOf(\"!\") ? value : value.substring(1)\r\n    }(value);\r\n    ! function(criteria, value) {\r\n        for (i = 0; i < criteria.length; i++) {\r\n            if (!Array.isArray(criteria[i])) {\r\n                criteria[i] = value\r\n            }\r\n        }\r\n    }(criteria, value);\r\n    return group\r\n}\r\nexport function getGroupMenuItem(group, availableGroups) {\r\n    const groupValue = getGroupValue(group);\r\n    return availableGroups.filter((item => item.value === groupValue))[0]\r\n}\r\n\r\nfunction getCriteriaOperation(criteria) {\r\n    if (isCondition(criteria)) {\r\n        return \"and\"\r\n    }\r\n    let value = \"\";\r\n    for (let i = 0; i < criteria.length; i++) {\r\n        const item = criteria[i];\r\n        if (!Array.isArray(item)) {\r\n            if (value && value !== item) {\r\n                throw dataErrors.Error(\"E4019\")\r\n            }\r\n            if (\"!\" !== item) {\r\n                value = item\r\n            }\r\n        }\r\n    }\r\n    return value\r\n}\r\nexport function getGroupValue(group) {\r\n    const criteria = getGroupCriteria(group);\r\n    let value = getCriteriaOperation(criteria);\r\n    if (!value) {\r\n        value = \"and\"\r\n    }\r\n    if (criteria !== group) {\r\n        value = `!${value}`\r\n    }\r\n    return value\r\n}\r\n\r\nfunction getDefaultFilterOperations(field) {\r\n    return field.lookup && LOOKUP_OPERATIONS || DATATYPE_OPERATIONS[field.dataType || \"string\"]\r\n}\r\n\r\nfunction containItems(entity) {\r\n    return Array.isArray(entity) && entity.length\r\n}\r\nexport function getFilterOperations(field) {\r\n    const result = containItems(field.filterOperations) ? field.filterOperations : getDefaultFilterOperations(field);\r\n    return extend([], result)\r\n}\r\nexport function getCaptionByOperation(operation, filterOperationDescriptions) {\r\n    const operationName = filterOperationsDictionary.getNameByFilterOperation(operation);\r\n    return filterOperationDescriptions && filterOperationDescriptions[operationName] ? filterOperationDescriptions[operationName] : operationName\r\n}\r\nexport function getOperationFromAvailable(operation, availableOperations) {\r\n    for (let i = 0; i < availableOperations.length; i++) {\r\n        if (availableOperations[i].value === operation) {\r\n            return availableOperations[i]\r\n        }\r\n    }\r\n    throw new errors.Error(\"E1048\", operation)\r\n}\r\nexport function getCustomOperation(customOperations, name) {\r\n    const filteredOperations = customOperations.filter((item => item.name === name));\r\n    return filteredOperations.length ? filteredOperations[0] : null\r\n}\r\nexport function getAvailableOperations(field, filterOperationDescriptions, customOperations) {\r\n    const filterOperations = getFilterOperations(field);\r\n    const isLookupField = !!field.lookup;\r\n    customOperations.forEach((customOperation => {\r\n        if (!field.filterOperations && -1 === filterOperations.indexOf(customOperation.name)) {\r\n            const dataTypes = customOperation && customOperation.dataTypes;\r\n            const isOperationForbidden = isLookupField ? !!customOperation.notForLookup : false;\r\n            if (!isOperationForbidden && dataTypes && dataTypes.indexOf(field.dataType || \"string\") >= 0) {\r\n                filterOperations.push(customOperation.name)\r\n            }\r\n        }\r\n    }));\r\n    return filterOperations.map((operation => {\r\n        const customOperation = getCustomOperation(customOperations, operation);\r\n        if (customOperation) {\r\n            return {\r\n                icon: customOperation.icon || \"icon-none\",\r\n                text: customOperation.caption || captionize(customOperation.name),\r\n                value: customOperation.name,\r\n                isCustom: true\r\n            }\r\n        }\r\n        return {\r\n            icon: filterOperationsDictionary.getIconByFilterOperation(operation) || \"icon-none\",\r\n            text: getCaptionByOperation(operation, filterOperationDescriptions),\r\n            value: operation\r\n        }\r\n    }))\r\n}\r\nexport function getDefaultOperation(field) {\r\n    return field.defaultFilterOperation || getFilterOperations(field)[0]\r\n}\r\nexport function createCondition(field, customOperations) {\r\n    const condition = [field.dataField, \"\", \"\"];\r\n    const filterOperation = getDefaultOperation(field);\r\n    updateConditionByOperation(condition, filterOperation, customOperations);\r\n    return condition\r\n}\r\nexport function removeItem(group, item) {\r\n    const criteria = getGroupCriteria(group);\r\n    const index = criteria.indexOf(item);\r\n    criteria.splice(index, 1);\r\n    if (1 !== criteria.length) {\r\n        criteria.splice(index, 1)\r\n    }\r\n    return group\r\n}\r\nexport function createEmptyGroup(value) {\r\n    const isNegation = isNegationGroupOperation(value);\r\n    const groupOperation = isNegation ? getGroupOperationFromNegationOperation(value) : value;\r\n    return isNegation ? [\"!\", [groupOperation]] : [groupOperation]\r\n}\r\nexport function isEmptyGroup(group) {\r\n    const criteria = getGroupCriteria(group);\r\n    if (isCondition(criteria)) {\r\n        return false\r\n    }\r\n    const hasConditions = criteria.some((item => isCondition(item)));\r\n    return !hasConditions\r\n}\r\nexport function addItem(item, group) {\r\n    const criteria = getGroupCriteria(group);\r\n    const groupValue = getGroupValue(criteria);\r\n    1 === criteria.length ? criteria.unshift(item) : criteria.push(item, groupValue);\r\n    return group\r\n}\r\nexport function getField(dataField, fields) {\r\n    for (let i = 0; i < fields.length; i++) {\r\n        if (fields[i].name === dataField) {\r\n            return fields[i]\r\n        }\r\n        if (fields[i].dataField.toLowerCase() === dataField.toLowerCase()) {\r\n            return fields[i]\r\n        }\r\n    }\r\n    const extendedFields = getItems(fields, true).filter((item => item.dataField.toLowerCase() === dataField.toLowerCase()));\r\n    if (extendedFields.length > 0) {\r\n        return extendedFields[0]\r\n    }\r\n    throw new errors.Error(\"E1047\", dataField)\r\n}\r\nexport function isGroup(criteria) {\r\n    if (!Array.isArray(criteria)) {\r\n        return false\r\n    }\r\n    return criteria.length < 2 || Array.isArray(criteria[0]) || Array.isArray(criteria[1])\r\n}\r\nexport function isCondition(criteria) {\r\n    if (!Array.isArray(criteria)) {\r\n        return false\r\n    }\r\n    return criteria.length > 1 && !Array.isArray(criteria[0]) && !Array.isArray(criteria[1])\r\n}\r\n\r\nfunction convertToInnerGroup(group, customOperations, defaultGroupOperation) {\r\n    defaultGroupOperation = defaultGroupOperation || \"and\";\r\n    const groupOperation = getCriteriaOperation(group).toLowerCase() || defaultGroupOperation;\r\n    let innerGroup = [];\r\n    for (let i = 0; i < group.length; i++) {\r\n        if (isGroup(group[i])) {\r\n            innerGroup.push(convertToInnerStructure(group[i], customOperations, defaultGroupOperation));\r\n            innerGroup = appendGroupOperationToGroup(innerGroup, groupOperation)\r\n        } else if (isCondition(group[i])) {\r\n            innerGroup.push(convertToInnerCondition(group[i], customOperations));\r\n            innerGroup = appendGroupOperationToGroup(innerGroup, groupOperation)\r\n        }\r\n    }\r\n    if (0 === innerGroup.length) {\r\n        innerGroup = appendGroupOperationToGroup(innerGroup, groupOperation)\r\n    }\r\n    return innerGroup\r\n}\r\n\r\nfunction conditionHasCustomOperation(condition, customOperations) {\r\n    const customOperation = getCustomOperation(customOperations, condition[1]);\r\n    return customOperation && customOperation.name === condition[1]\r\n}\r\n\r\nfunction convertToInnerCondition(condition, customOperations) {\r\n    if (conditionHasCustomOperation(condition, customOperations)) {\r\n        return condition\r\n    }\r\n    if (condition.length < 3) {\r\n        condition[2] = condition[1];\r\n        condition[1] = \"=\"\r\n    }\r\n    return condition\r\n}\r\n\r\nfunction isNegationGroupOperation(operation) {\r\n    return -1 !== operation.indexOf(\"not\")\r\n}\r\n\r\nfunction getGroupOperationFromNegationOperation(operation) {\r\n    return operation.substring(3).toLowerCase()\r\n}\r\n\r\nfunction appendGroupOperationToCriteria(criteria, groupOperation) {\r\n    const isNegation = isNegationGroupOperation(groupOperation);\r\n    groupOperation = isNegation ? getGroupOperationFromNegationOperation(groupOperation) : groupOperation;\r\n    return isNegation ? [\"!\", criteria, groupOperation] : [criteria, groupOperation]\r\n}\r\n\r\nfunction appendGroupOperationToGroup(group, groupOperation) {\r\n    const isNegation = isNegationGroupOperation(groupOperation);\r\n    groupOperation = isNegation ? getGroupOperationFromNegationOperation(groupOperation) : groupOperation;\r\n    group.push(groupOperation);\r\n    let result = group;\r\n    if (isNegation) {\r\n        result = [\"!\", result]\r\n    }\r\n    return result\r\n}\r\nexport function convertToInnerStructure(value, customOperations, defaultGroupOperation) {\r\n    defaultGroupOperation = defaultGroupOperation || \"and\";\r\n    if (!value) {\r\n        return createEmptyGroup(defaultGroupOperation)\r\n    }\r\n    value = extend(true, [], value);\r\n    if (isCondition(value)) {\r\n        return appendGroupOperationToCriteria(convertToInnerCondition(value, customOperations), defaultGroupOperation)\r\n    }\r\n    if (isNegationGroup(value)) {\r\n        return [\"!\", isCondition(value[1]) ? appendGroupOperationToCriteria(convertToInnerCondition(value[1], customOperations), defaultGroupOperation) : isNegationGroup(value[1]) ? appendGroupOperationToCriteria(convertToInnerStructure(value[1], customOperations), defaultGroupOperation) : convertToInnerGroup(value[1], customOperations, defaultGroupOperation)]\r\n    }\r\n    return convertToInnerGroup(value, customOperations, defaultGroupOperation)\r\n}\r\nexport function getNormalizedFields(fields) {\r\n    return fields.reduce(((result, field) => {\r\n        if (isDefined(field.dataField)) {\r\n            const normalizedField = {};\r\n            for (const key in field) {\r\n                if (field[key] && AVAILABLE_FIELD_PROPERTIES.includes(key)) {\r\n                    normalizedField[key] = field[key]\r\n                }\r\n            }\r\n            normalizedField.defaultCalculateFilterExpression = filterUtils.defaultCalculateFilterExpression;\r\n            if (!isDefined(normalizedField.dataType)) {\r\n                normalizedField.dataType = \"string\"\r\n            }\r\n            if (!isDefined(normalizedField.trueText)) {\r\n                normalizedField.trueText = messageLocalization.format(\"dxDataGrid-trueText\")\r\n            }\r\n            if (!isDefined(normalizedField.falseText)) {\r\n                normalizedField.falseText = messageLocalization.format(\"dxDataGrid-falseText\")\r\n            }\r\n            result.push(normalizedField)\r\n        }\r\n        return result\r\n    }), [])\r\n}\r\n\r\nfunction getConditionFilterExpression(condition, fields, customOperations, target) {\r\n    const field = getField(condition[0], fields);\r\n    const filterExpression = convertToInnerCondition(condition, customOperations);\r\n    const customOperation = customOperations.length && getCustomOperation(customOperations, filterExpression[1]);\r\n    if (customOperation && customOperation.calculateFilterExpression) {\r\n        return customOperation.calculateFilterExpression.apply(customOperation, [filterExpression[2], field, fields])\r\n    }\r\n    if (field.createFilterExpression) {\r\n        return field.createFilterExpression.apply(field, [filterExpression[2], filterExpression[1], target])\r\n    }\r\n    if (field.calculateFilterExpression) {\r\n        return field.calculateFilterExpression.apply(field, [filterExpression[2], filterExpression[1], target])\r\n    }\r\n    return field.defaultCalculateFilterExpression.apply(field, [filterExpression[2], filterExpression[1], target])\r\n}\r\nexport function getFilterExpression(value, fields, customOperations, target) {\r\n    if (!isDefined(value)) {\r\n        return null\r\n    }\r\n    if (isNegationGroup(value)) {\r\n        const filterExpression = getFilterExpression(value[1], fields, customOperations, target);\r\n        return [\"!\", filterExpression]\r\n    }\r\n    const criteria = getGroupCriteria(value);\r\n    if (isCondition(criteria)) {\r\n        return getConditionFilterExpression(criteria, fields, customOperations, target) || null\r\n    }\r\n    let result = [];\r\n    let filterExpression;\r\n    const groupValue = getGroupValue(criteria);\r\n    for (let i = 0; i < criteria.length; i++) {\r\n        if (isGroup(criteria[i])) {\r\n            filterExpression = getFilterExpression(criteria[i], fields, customOperations, target);\r\n            if (filterExpression) {\r\n                i && result.push(groupValue);\r\n                result.push(filterExpression)\r\n            }\r\n        } else if (isCondition(criteria[i])) {\r\n            filterExpression = getConditionFilterExpression(criteria[i], fields, customOperations, target);\r\n            if (filterExpression) {\r\n                result.length && result.push(groupValue);\r\n                result.push(filterExpression)\r\n            }\r\n        }\r\n    }\r\n    if (1 === result.length) {\r\n        result = result[0]\r\n    }\r\n    return result.length ? result : null\r\n}\r\nexport function getNormalizedFilter(group) {\r\n    const criteria = getGroupCriteria(group);\r\n    let i;\r\n    if (0 === criteria.length) {\r\n        return null\r\n    }\r\n    const itemsForRemove = [];\r\n    for (i = 0; i < criteria.length; i++) {\r\n        if (isGroup(criteria[i])) {\r\n            const normalizedGroupValue = getNormalizedFilter(criteria[i]);\r\n            if (normalizedGroupValue) {\r\n                criteria[i] = normalizedGroupValue\r\n            } else {\r\n                itemsForRemove.push(criteria[i])\r\n            }\r\n        } else if (isCondition(criteria[i])) {\r\n            if (!isValidCondition(criteria[i])) {\r\n                itemsForRemove.push(criteria[i])\r\n            }\r\n        }\r\n    }\r\n    for (i = 0; i < itemsForRemove.length; i++) {\r\n        removeItem(criteria, itemsForRemove[i])\r\n    }\r\n    if (1 === criteria.length) {\r\n        return null\r\n    }\r\n    criteria.splice(criteria.length - 1, 1);\r\n    if (1 === criteria.length) {\r\n        group = setGroupCriteria(group, criteria[0])\r\n    }\r\n    if (0 === group.length) {\r\n        return null\r\n    }\r\n    return group\r\n}\r\nexport function getCurrentLookupValueText(field, value, handler) {\r\n    if (\"\" === value) {\r\n        handler(\"\");\r\n        return\r\n    }\r\n    const {\r\n        lookup: lookup\r\n    } = field;\r\n    if (lookup.items) {\r\n        handler(lookup.calculateCellValue(value) || \"\")\r\n    } else {\r\n        const lookupDataSource = isFunction(lookup.dataSource) ? lookup.dataSource({}) : lookup.dataSource;\r\n        const dataSource = new DataSource(lookupDataSource);\r\n        dataSource.loadSingle(lookup.valueExpr, value).done((result => {\r\n            let valueText = \"\";\r\n            if (result) {\r\n                valueText = lookup.displayExpr ? compileGetter(lookup.displayExpr)(result) : result\r\n            }\r\n            if (field.customizeText) {\r\n                valueText = field.customizeText({\r\n                    value: value,\r\n                    valueText: valueText\r\n                })\r\n            }\r\n            handler(valueText)\r\n        })).fail((() => {\r\n            handler(\"\")\r\n        }))\r\n    }\r\n}\r\n\r\nfunction getPrimitiveValueText(field, value, customOperation, target, options) {\r\n    let valueText;\r\n    if (true === value) {\r\n        valueText = field.trueText || messageLocalization.format(\"dxDataGrid-trueText\")\r\n    } else if (false === value) {\r\n        valueText = field.falseText || messageLocalization.format(\"dxDataGrid-falseText\")\r\n    } else {\r\n        valueText = getFormattedValueText(field, value)\r\n    }\r\n    if (field.customizeText) {\r\n        valueText = field.customizeText.call(field, {\r\n            value: value,\r\n            valueText: valueText,\r\n            target: target\r\n        })\r\n    }\r\n    if (customOperation && customOperation.customizeText) {\r\n        valueText = customOperation.customizeText.call(customOperation, {\r\n            value: value,\r\n            valueText: valueText,\r\n            field: field,\r\n            target: target\r\n        }, options)\r\n    }\r\n    return valueText\r\n}\r\n\r\nfunction getArrayValueText(field, value, customOperation, target) {\r\n    const options = {\r\n        values: value\r\n    };\r\n    return value.map((v => getPrimitiveValueText(field, v, customOperation, target, options)))\r\n}\r\n\r\nfunction checkDefaultValue(value) {\r\n    return \"\" === value || null === value\r\n}\r\nexport function getCurrentValueText(field, value, customOperation) {\r\n    let target = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : \"filterBuilder\";\r\n    if (checkDefaultValue(value)) {\r\n        return \"\"\r\n    }\r\n    if (Array.isArray(value)) {\r\n        const result = new Deferred;\r\n        when.apply(this, getArrayValueText(field, value, customOperation, target)).done((function() {\r\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\r\n                args[_key] = arguments[_key]\r\n            }\r\n            const text = args.some((item => !checkDefaultValue(item))) ? args.map((item => !checkDefaultValue(item) ? item : \"?\")) : \"\";\r\n            result.resolve(text)\r\n        }));\r\n        return result\r\n    }\r\n    return getPrimitiveValueText(field, value, customOperation, target)\r\n}\r\n\r\nfunction itemExists(plainItems, parentId) {\r\n    return plainItems.some((item => item.dataField === parentId))\r\n}\r\n\r\nfunction pushItemAndCheckParent(originalItems, plainItems, item) {\r\n    const {\r\n        dataField: dataField\r\n    } = item;\r\n    if (hasParent(dataField)) {\r\n        item.parentId = getParentIdFromItemDataField(dataField);\r\n        if (!itemExists(plainItems, item.parentId) && !itemExists(originalItems, item.parentId)) {\r\n            pushItemAndCheckParent(originalItems, plainItems, {\r\n                id: item.parentId,\r\n                dataType: \"object\",\r\n                dataField: item.parentId,\r\n                caption: generateCaptionByDataField(item.parentId, true),\r\n                filterOperations: [\"isblank\", \"isnotblank\"],\r\n                defaultCalculateFilterExpression: filterUtils.defaultCalculateFilterExpression\r\n            })\r\n        }\r\n    }\r\n    plainItems.push(item)\r\n}\r\n\r\nfunction generateCaptionByDataField(dataField, allowHierarchicalFields) {\r\n    let caption = \"\";\r\n    if (allowHierarchicalFields) {\r\n        dataField = dataField.substring(dataField.lastIndexOf(\".\") + 1)\r\n    } else if (hasParent(dataField)) {\r\n        dataField.split(\".\").forEach(((field, index, arr) => {\r\n            caption += captionize(field);\r\n            if (index !== arr.length - 1) {\r\n                caption += \".\"\r\n            }\r\n        }));\r\n        return caption\r\n    }\r\n    return captionize(dataField)\r\n}\r\nexport function getItems(fields, allowHierarchicalFields) {\r\n    const items = [];\r\n    for (let i = 0; i < fields.length; i++) {\r\n        const item = extend(true, {\r\n            caption: generateCaptionByDataField(fields[i].dataField, allowHierarchicalFields)\r\n        }, fields[i]);\r\n        item.id = item.name || item.dataField;\r\n        if (allowHierarchicalFields) {\r\n            pushItemAndCheckParent(fields, items, item)\r\n        } else {\r\n            items.push(item)\r\n        }\r\n    }\r\n    return items\r\n}\r\n\r\nfunction hasParent(dataField) {\r\n    return -1 !== dataField.lastIndexOf(\".\")\r\n}\r\n\r\nfunction getParentIdFromItemDataField(dataField) {\r\n    return dataField.substring(0, dataField.lastIndexOf(\".\"))\r\n}\r\nexport function getCaptionWithParents(item, plainItems) {\r\n    if (hasParent(item.dataField)) {\r\n        const parentId = getParentIdFromItemDataField(item.dataField);\r\n        for (let i = 0; i < plainItems.length; i++) {\r\n            if (plainItems[i].dataField === parentId) {\r\n                return `${getCaptionWithParents(plainItems[i],plainItems)}.${item.caption}`\r\n            }\r\n        }\r\n    }\r\n    return item.caption\r\n}\r\nexport function updateConditionByOperation(condition, operation, customOperations) {\r\n    let customOperation = getCustomOperation(customOperations, operation);\r\n    if (customOperation) {\r\n        if (false === customOperation.hasValue) {\r\n            condition[1] = operation;\r\n            condition.length = 2\r\n        } else {\r\n            condition[1] = operation;\r\n            condition[2] = \"\"\r\n        }\r\n        return condition\r\n    }\r\n    if (\"isblank\" === operation) {\r\n        condition[1] = \"=\";\r\n        condition[2] = null\r\n    } else if (\"isnotblank\" === operation) {\r\n        condition[1] = \"<>\";\r\n        condition[2] = null\r\n    } else {\r\n        customOperation = getCustomOperation(customOperations, condition[1]);\r\n        if (customOperation || 2 === condition.length || null === condition[2]) {\r\n            condition[2] = \"\"\r\n        }\r\n        condition[1] = operation\r\n    }\r\n    return condition\r\n}\r\nexport function getOperationValue(condition) {\r\n    let caption;\r\n    if (null === condition[2]) {\r\n        if (\"=\" === condition[1]) {\r\n            caption = \"isblank\"\r\n        } else {\r\n            caption = \"isnotblank\"\r\n        }\r\n    } else {\r\n        caption = condition[1]\r\n    }\r\n    return caption\r\n}\r\nexport function isValidCondition(condition) {\r\n    return \"\" !== condition[2]\r\n}\r\nexport function getMergedOperations(customOperations, betweenCaption, context) {\r\n    const result = extend(true, [], customOperations);\r\n    let betweenIndex = -1;\r\n    result.some(((customOperation, index) => {\r\n        if (\"between\" === customOperation.name) {\r\n            betweenIndex = index;\r\n            return true\r\n        }\r\n        return\r\n    }));\r\n    if (-1 !== betweenIndex) {\r\n        result[betweenIndex] = extend(getConfig(betweenCaption, context), result[betweenIndex])\r\n    } else {\r\n        result.unshift(getConfig(betweenCaption, context))\r\n    }\r\n    return result\r\n}\r\n\r\nfunction isMatchedCondition(filter, addedFilterDataField) {\r\n    return filter[0] === addedFilterDataField\r\n}\r\nexport function removeFieldConditionsFromFilter(filter, dataField) {\r\n    if (!filter || 0 === filter.length) {\r\n        return null\r\n    }\r\n    if (isCondition(filter)) {\r\n        const hasMatchedCondition = isMatchedCondition(filter, dataField);\r\n        return !hasMatchedCondition ? filter : null\r\n    }\r\n    return syncConditionIntoGroup(filter, [dataField], false)\r\n}\r\n\r\nfunction syncConditionIntoGroup(filter, addedFilter, canPush) {\r\n    const result = [];\r\n    filter.forEach((item => {\r\n        if (isCondition(item)) {\r\n            if (isMatchedCondition(item, addedFilter[0])) {\r\n                if (canPush) {\r\n                    result.push(addedFilter);\r\n                    canPush = false\r\n                } else {\r\n                    result.splice(result.length - 1, 1)\r\n                }\r\n            } else {\r\n                result.push(item)\r\n            }\r\n        } else {\r\n            (result.length || isGroup(item)) && result.push(item)\r\n        }\r\n    }));\r\n    if (0 === result.length) {\r\n        return null\r\n    }\r\n    if (canPush) {\r\n        result.push(\"and\");\r\n        result.push(addedFilter)\r\n    }\r\n    return 1 === result.length ? result[0] : result\r\n}\r\nexport function syncFilters(filter, addedFilter) {\r\n    if (null === filter || 0 === filter.length) {\r\n        return addedFilter\r\n    }\r\n    if (isCondition(filter)) {\r\n        if (isMatchedCondition(filter, addedFilter[0])) {\r\n            return addedFilter\r\n        }\r\n        return [filter, \"and\", addedFilter]\r\n    }\r\n    const groupValue = getGroupValue(filter);\r\n    if (\"and\" !== groupValue) {\r\n        return [addedFilter, \"and\", filter]\r\n    }\r\n    return syncConditionIntoGroup(filter, addedFilter, true)\r\n}\r\nexport function getMatchedConditions(filter, dataField) {\r\n    if (null === filter || 0 === filter.length) {\r\n        return []\r\n    }\r\n    if (isCondition(filter)) {\r\n        if (isMatchedCondition(filter, dataField)) {\r\n            return [filter]\r\n        }\r\n        return []\r\n    }\r\n    const groupValue = getGroupValue(filter);\r\n    if (\"and\" !== groupValue) {\r\n        return []\r\n    }\r\n    const result = filter.filter((item => isCondition(item) && isMatchedCondition(item, dataField)));\r\n    return result\r\n}\r\nexport function filterHasField(filter, dataField) {\r\n    if (null === filter || 0 === filter.length) {\r\n        return false\r\n    }\r\n    if (isCondition(filter)) {\r\n        return filter[0] === dataField\r\n    }\r\n    return filter.some((item => (isCondition(item) || isGroup(item)) && filterHasField(item, dataField)))\r\n}\r\nexport const renderValueText = function($container, value, customOperation) {\r\n    if (Array.isArray(value)) {\r\n        const lastItemIndex = value.length - 1;\r\n        $container.empty();\r\n        value.forEach(((t, i) => {\r\n            $(\"<span>\").addClass(\"dx-filterbuilder-text-part\").text(t).appendTo($container);\r\n            if (i !== lastItemIndex) {\r\n                $(\"<span>\").addClass(\"dx-filterbuilder-text-separator\").text(customOperation && customOperation.valueSeparator ? customOperation.valueSeparator : \"|\").addClass(\"dx-filterbuilder-text-separator-empty\").appendTo($container)\r\n            }\r\n        }))\r\n    } else if (value) {\r\n        $container.text(value)\r\n    } else {\r\n        $container.text(messageLocalization.format(\"dxFilterBuilder-enterValueText\"))\r\n    }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}